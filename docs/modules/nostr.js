var ws=Object.defineProperty;var An=(e,t)=>{for(var n in t)ws(e,n,{get:t[n],enumerable:!0})};function kr(e){if(!Number.isSafeInteger(e)||e<0)throw new Error(`Wrong positive integer: ${e}`)}function Ln(e,...t){if(!(e instanceof Uint8Array))throw new Error("Expected Uint8Array");if(t.length>0&&!t.includes(e.length))throw new Error(`Expected Uint8Array of length ${t}, not of length=${e.length}`)}function qr(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");kr(e.outputLen),kr(e.blockLen)}function ue(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function Cr(e,t){Ln(e);let n=t.outputLen;if(e.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}var Ce=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;var Rr=e=>e instanceof Uint8Array;var Re=e=>new DataView(e.buffer,e.byteOffset,e.byteLength),yt=(e,t)=>e<<32-t|e>>>t,ys=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!ys)throw new Error("Non little-endian hardware is not supported");function bs(e){if(typeof e!="string")throw new Error(`utf8ToBytes expected string, got ${typeof e}`);return new Uint8Array(new TextEncoder().encode(e))}function Ie(e){if(typeof e=="string"&&(e=bs(e)),!Rr(e))throw new Error(`expected Uint8Array, got ${typeof e}`);return e}function $r(...e){let t=new Uint8Array(e.reduce((r,o)=>r+o.length,0)),n=0;return e.forEach(r=>{if(!Rr(r))throw new Error("Uint8Array expected");t.set(r,n),n+=r.length}),t}var le=class{clone(){return this._cloneInto()}},Yc={}.toString;function Vr(e){let t=r=>e().update(Ie(r)).digest(),n=e();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=()=>e(),t}function $e(e=32){if(Ce&&typeof Ce.getRandomValues=="function")return Ce.getRandomValues(new Uint8Array(e));throw new Error("crypto.getRandomValues must be defined")}function xs(e,t,n,r){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,n,r);let o=BigInt(32),s=BigInt(4294967295),i=Number(n>>o&s),c=Number(n&s),f=r?4:0,a=r?0:4;e.setUint32(t+f,i,r),e.setUint32(t+a,c,r)}var Ve=class extends le{constructor(t,n,r,o){super(),this.blockLen=t,this.outputLen=n,this.padOffset=r,this.isLE=o,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=Re(this.buffer)}update(t){ue(this);let{view:n,buffer:r,blockLen:o}=this;t=Ie(t);let s=t.length;for(let i=0;i<s;){let c=Math.min(o-this.pos,s-i);if(c===o){let f=Re(t);for(;o<=s-i;i+=o)this.process(f,i);continue}r.set(t.subarray(i,i+c),this.pos),this.pos+=c,i+=c,this.pos===o&&(this.process(n,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){ue(this),Cr(t,this),this.finished=!0;let{buffer:n,view:r,blockLen:o,isLE:s}=this,{pos:i}=this;n[i++]=128,this.buffer.subarray(i).fill(0),this.padOffset>o-i&&(this.process(r,0),i=0);for(let u=i;u<o;u++)n[u]=0;xs(r,o-8,BigInt(this.length*8),s),this.process(r,0);let c=Re(t),f=this.outputLen;if(f%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let a=f/4,l=this.get();if(a>l.length)throw new Error("_sha2: outputLen bigger than state");for(let u=0;u<a;u++)c.setUint32(4*u,l[u],s)}digest(){let{buffer:t,outputLen:n}=this;this.digestInto(t);let r=t.slice(0,n);return this.destroy(),r}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());let{blockLen:n,buffer:r,length:o,finished:s,destroyed:i,pos:c}=this;return t.length=o,t.pos=c,t.finished=s,t.destroyed=i,o%n&&t.buffer.set(r),t}};var ms=(e,t,n)=>e&t^~e&n,Es=(e,t,n)=>e&t^e&n^t&n,Bs=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Rt=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),$t=new Uint32Array(64),Sn=class extends Ve{constructor(){super(64,32,8,!1),this.A=Rt[0]|0,this.B=Rt[1]|0,this.C=Rt[2]|0,this.D=Rt[3]|0,this.E=Rt[4]|0,this.F=Rt[5]|0,this.G=Rt[6]|0,this.H=Rt[7]|0}get(){let{A:t,B:n,C:r,D:o,E:s,F:i,G:c,H:f}=this;return[t,n,r,o,s,i,c,f]}set(t,n,r,o,s,i,c,f){this.A=t|0,this.B=n|0,this.C=r|0,this.D=o|0,this.E=s|0,this.F=i|0,this.G=c|0,this.H=f|0}process(t,n){for(let u=0;u<16;u++,n+=4)$t[u]=t.getUint32(n,!1);for(let u=16;u<64;u++){let g=$t[u-15],y=$t[u-2],p=yt(g,7)^yt(g,18)^g>>>3,d=yt(y,17)^yt(y,19)^y>>>10;$t[u]=d+$t[u-7]+p+$t[u-16]|0}let{A:r,B:o,C:s,D:i,E:c,F:f,G:a,H:l}=this;for(let u=0;u<64;u++){let g=yt(c,6)^yt(c,11)^yt(c,25),y=l+g+ms(c,f,a)+Bs[u]+$t[u]|0,d=(yt(r,2)^yt(r,13)^yt(r,22))+Es(r,o,s)|0;l=a,a=f,f=c,c=i+y|0,i=s,s=o,o=r,r=y+d|0}r=r+this.A|0,o=o+this.B|0,s=s+this.C|0,i=i+this.D|0,c=c+this.E|0,f=f+this.F|0,a=a+this.G|0,l=l+this.H|0,this.set(r,o,s,i,c,f,a,l)}roundClean(){$t.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};var Ke=Vr(()=>new Sn);var _n={};An(_n,{bitGet:()=>Ts,bitLen:()=>Us,bitMask:()=>Ue,bitSet:()=>_s,bytesToHex:()=>te,bytesToNumberBE:()=>et,bytesToNumberLE:()=>ze,concatBytes:()=>St,createHmacDrbg:()=>Tn,ensureBytes:()=>X,equalBytes:()=>Ss,hexToBytes:()=>ee,hexToNumber:()=>Un,numberToBytesBE:()=>bt,numberToBytesLE:()=>Ze,numberToHexUnpadded:()=>Pr,numberToVarBytesBE:()=>Ls,utf8ToBytes:()=>Is,validateObject:()=>Vt});var jr=BigInt(0),je=BigInt(1),vs=BigInt(2),Pe=e=>e instanceof Uint8Array,As=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function te(e){if(!Pe(e))throw new Error("Uint8Array expected");let t="";for(let n=0;n<e.length;n++)t+=As[e[n]];return t}function Pr(e){let t=e.toString(16);return t.length&1?`0${t}`:t}function Un(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);return BigInt(e===""?"0":`0x${e}`)}function ee(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);let t=e.length;if(t%2)throw new Error("padded hex string expected, got unpadded hex of length "+t);let n=new Uint8Array(t/2);for(let r=0;r<n.length;r++){let o=r*2,s=e.slice(o,o+2),i=Number.parseInt(s,16);if(Number.isNaN(i)||i<0)throw new Error("Invalid byte sequence");n[r]=i}return n}function et(e){return Un(te(e))}function ze(e){if(!Pe(e))throw new Error("Uint8Array expected");return Un(te(Uint8Array.from(e).reverse()))}function bt(e,t){return ee(e.toString(16).padStart(t*2,"0"))}function Ze(e,t){return bt(e,t).reverse()}function Ls(e){return ee(Pr(e))}function X(e,t,n){let r;if(typeof t=="string")try{r=ee(t)}catch(s){throw new Error(`${e} must be valid hex string, got "${t}". Cause: ${s}`)}else if(Pe(t))r=Uint8Array.from(t);else throw new Error(`${e} must be hex string or Uint8Array`);let o=r.length;if(typeof n=="number"&&o!==n)throw new Error(`${e} expected ${n} bytes, got ${o}`);return r}function St(...e){let t=new Uint8Array(e.reduce((r,o)=>r+o.length,0)),n=0;return e.forEach(r=>{if(!Pe(r))throw new Error("Uint8Array expected");t.set(r,n),n+=r.length}),t}function Ss(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function Is(e){if(typeof e!="string")throw new Error(`utf8ToBytes expected string, got ${typeof e}`);return new Uint8Array(new TextEncoder().encode(e))}function Us(e){let t;for(t=0;e>jr;e>>=je,t+=1);return t}function Ts(e,t){return e>>BigInt(t)&je}var _s=(e,t,n)=>e|(n?je:jr)<<BigInt(t),Ue=e=>(vs<<BigInt(e-1))-je,In=e=>new Uint8Array(e),Kr=e=>Uint8Array.from(e);function Tn(e,t,n){if(typeof e!="number"||e<2)throw new Error("hashLen must be a number");if(typeof t!="number"||t<2)throw new Error("qByteLen must be a number");if(typeof n!="function")throw new Error("hmacFn must be a function");let r=In(e),o=In(e),s=0,i=()=>{r.fill(1),o.fill(0),s=0},c=(...u)=>n(o,r,...u),f=(u=In())=>{o=c(Kr([0]),u),r=c(),u.length!==0&&(o=c(Kr([1]),u),r=c())},a=()=>{if(s++>=1e3)throw new Error("drbg: tried 1000 values");let u=0,g=[];for(;u<t;){r=c();let y=r.slice();g.push(y),u+=r.length}return St(...g)};return(u,g)=>{i(),f(u);let y;for(;!(y=g(a()));)f();return i(),y}}var Os={bigint:e=>typeof e=="bigint",function:e=>typeof e=="function",boolean:e=>typeof e=="boolean",string:e=>typeof e=="string",stringOrUint8Array:e=>typeof e=="string"||e instanceof Uint8Array,isSafeInteger:e=>Number.isSafeInteger(e),array:e=>Array.isArray(e),field:(e,t)=>t.Fp.isValid(e),hash:e=>typeof e=="function"&&Number.isSafeInteger(e.outputLen)};function Vt(e,t,n={}){let r=(o,s,i)=>{let c=Os[s];if(typeof c!="function")throw new Error(`Invalid validator "${s}", expected function`);let f=e[o];if(!(i&&f===void 0)&&!c(f,e))throw new Error(`Invalid param ${String(o)}=${f} (${typeof f}), expected ${s}`)};for(let[o,s]of Object.entries(t))r(o,s,!1);for(let[o,s]of Object.entries(n))r(o,s,!0);return e}var J=BigInt(0),W=BigInt(1),ne=BigInt(2),Ns=BigInt(3),On=BigInt(4),zr=BigInt(5),Zr=BigInt(8),Hs=BigInt(9),ks=BigInt(16);function Q(e,t){let n=e%t;return n>=J?n:t+n}function qs(e,t,n){if(n<=J||t<J)throw new Error("Expected power/modulo > 0");if(n===W)return J;let r=W;for(;t>J;)t&W&&(r=r*e%n),e=e*e%n,t>>=W;return r}function at(e,t,n){let r=e;for(;t-- >J;)r*=r,r%=n;return r}function Me(e,t){if(e===J||t<=J)throw new Error(`invert: expected positive integers, got n=${e} mod=${t}`);let n=Q(e,t),r=t,o=J,s=W,i=W,c=J;for(;n!==J;){let a=r/n,l=r%n,u=o-i*a,g=s-c*a;r=n,n=l,o=i,s=c,i=u,c=g}if(r!==W)throw new Error("invert: does not exist");return Q(o,t)}function Cs(e){let t=(e-W)/ne,n,r,o;for(n=e-W,r=0;n%ne===J;n/=ne,r++);for(o=ne;o<e&&qs(o,t,e)!==e-W;o++);if(r===1){let i=(e+W)/On;return function(f,a){let l=f.pow(a,i);if(!f.eql(f.sqr(l),a))throw new Error("Cannot find square root");return l}}let s=(n+W)/ne;return function(c,f){if(c.pow(f,t)===c.neg(c.ONE))throw new Error("Cannot find square root");let a=r,l=c.pow(c.mul(c.ONE,o),n),u=c.pow(f,s),g=c.pow(f,n);for(;!c.eql(g,c.ONE);){if(c.eql(g,c.ZERO))return c.ZERO;let y=1;for(let d=c.sqr(g);y<a&&!c.eql(d,c.ONE);y++)d=c.sqr(d);let p=c.pow(l,W<<BigInt(a-y-1));l=c.sqr(p),u=c.mul(u,p),g=c.mul(g,l),a=y}return u}}function Rs(e){if(e%On===Ns){let t=(e+W)/On;return function(r,o){let s=r.pow(o,t);if(!r.eql(r.sqr(s),o))throw new Error("Cannot find square root");return s}}if(e%Zr===zr){let t=(e-zr)/Zr;return function(r,o){let s=r.mul(o,ne),i=r.pow(s,t),c=r.mul(o,i),f=r.mul(r.mul(c,ne),i),a=r.mul(c,r.sub(f,r.ONE));if(!r.eql(r.sqr(a),o))throw new Error("Cannot find square root");return a}}return e%ks,Cs(e)}var $s=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function Nn(e){let t={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},n=$s.reduce((r,o)=>(r[o]="function",r),t);return Vt(e,n)}function Vs(e,t,n){if(n<J)throw new Error("Expected power > 0");if(n===J)return e.ONE;if(n===W)return t;let r=e.ONE,o=t;for(;n>J;)n&W&&(r=e.mul(r,o)),o=e.sqr(o),n>>=W;return r}function Ks(e,t){let n=new Array(t.length),r=t.reduce((s,i,c)=>e.is0(i)?s:(n[c]=s,e.mul(s,i)),e.ONE),o=e.inv(r);return t.reduceRight((s,i,c)=>e.is0(i)?s:(n[c]=e.mul(s,n[c]),e.mul(s,i)),o),n}function Hn(e,t){let n=t!==void 0?t:e.toString(2).length,r=Math.ceil(n/8);return{nBitLength:n,nByteLength:r}}function Mr(e,t,n=!1,r={}){if(e<=J)throw new Error(`Expected Field ORDER > 0, got ${e}`);let{nBitLength:o,nByteLength:s}=Hn(e,t);if(s>2048)throw new Error("Field lengths over 2048 bytes are not supported");let i=Rs(e),c=Object.freeze({ORDER:e,BITS:o,BYTES:s,MASK:Ue(o),ZERO:J,ONE:W,create:f=>Q(f,e),isValid:f=>{if(typeof f!="bigint")throw new Error(`Invalid field element: expected bigint, got ${typeof f}`);return J<=f&&f<e},is0:f=>f===J,isOdd:f=>(f&W)===W,neg:f=>Q(-f,e),eql:(f,a)=>f===a,sqr:f=>Q(f*f,e),add:(f,a)=>Q(f+a,e),sub:(f,a)=>Q(f-a,e),mul:(f,a)=>Q(f*a,e),pow:(f,a)=>Vs(c,f,a),div:(f,a)=>Q(f*Me(a,e),e),sqrN:f=>f*f,addN:(f,a)=>f+a,subN:(f,a)=>f-a,mulN:(f,a)=>f*a,inv:f=>Me(f,e),sqrt:r.sqrt||(f=>i(c,f)),invertBatch:f=>Ks(c,f),cmov:(f,a,l)=>l?a:f,toBytes:f=>n?Ze(f,s):bt(f,s),fromBytes:f=>{if(f.length!==s)throw new Error(`Fp.fromBytes: expected ${s}, got ${f.length}`);return n?ze(f):et(f)}});return Object.freeze(c)}function Dr(e){if(typeof e!="bigint")throw new Error("field order must be bigint");let t=e.toString(2).length;return Math.ceil(t/8)}function kn(e){let t=Dr(e);return t+Math.ceil(t/2)}function Wr(e,t,n=!1){let r=e.length,o=Dr(t),s=kn(t);if(r<16||r<s||r>1024)throw new Error(`expected ${s}-1024 bytes of input, got ${r}`);let i=n?et(e):ze(e),c=Q(i,t-W)+W;return n?Ze(c,o):bt(c,o)}var Ps=BigInt(0),qn=BigInt(1);function Gr(e,t){let n=(o,s)=>{let i=s.negate();return o?i:s},r=o=>{let s=Math.ceil(t/o)+1,i=2**(o-1);return{windows:s,windowSize:i}};return{constTimeNegate:n,unsafeLadder(o,s){let i=e.ZERO,c=o;for(;s>Ps;)s&qn&&(i=i.add(c)),c=c.double(),s>>=qn;return i},precomputeWindow(o,s){let{windows:i,windowSize:c}=r(s),f=[],a=o,l=a;for(let u=0;u<i;u++){l=a,f.push(l);for(let g=1;g<c;g++)l=l.add(a),f.push(l);a=l.double()}return f},wNAF(o,s,i){let{windows:c,windowSize:f}=r(o),a=e.ZERO,l=e.BASE,u=BigInt(2**o-1),g=2**o,y=BigInt(o);for(let p=0;p<c;p++){let d=p*f,h=Number(i&u);i>>=y,h>f&&(h-=g,i+=qn);let w=d,x=d+Math.abs(h)-1,E=p%2!==0,L=h<0;h===0?l=l.add(n(E,s[w])):a=a.add(n(L,s[x]))}return{p:a,f:l}},wNAFCached(o,s,i,c){let f=o._WINDOW_SIZE||1,a=s.get(o);return a||(a=this.precomputeWindow(o,f),f!==1&&s.set(o,c(a))),this.wNAF(f,a,i)}}}function Cn(e){return Nn(e.Fp),Vt(e,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...Hn(e.n,e.nBitLength),...e,p:e.Fp.ORDER})}function zs(e){let t=Cn(e);Vt(t,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});let{endo:n,Fp:r,a:o}=t;if(n){if(!r.eql(o,r.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if(typeof n!="object"||typeof n.beta!="bigint"||typeof n.splitScalar!="function")throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...t})}var{bytesToNumberBE:Zs,hexToBytes:Ms}=_n,re={Err:class extends Error{constructor(t=""){super(t)}},_parseInt(e){let{Err:t}=re;if(e.length<2||e[0]!==2)throw new t("Invalid signature integer tag");let n=e[1],r=e.subarray(2,n+2);if(!n||r.length!==n)throw new t("Invalid signature integer: wrong length");if(r[0]&128)throw new t("Invalid signature integer: negative");if(r[0]===0&&!(r[1]&128))throw new t("Invalid signature integer: unnecessary leading zero");return{d:Zs(r),l:e.subarray(n+2)}},toSig(e){let{Err:t}=re,n=typeof e=="string"?Ms(e):e;if(!(n instanceof Uint8Array))throw new Error("ui8a expected");let r=n.length;if(r<2||n[0]!=48)throw new t("Invalid signature tag");if(n[1]!==r-2)throw new t("Invalid signature: incorrect length");let{d:o,l:s}=re._parseInt(n.subarray(2)),{d:i,l:c}=re._parseInt(s);if(c.length)throw new t("Invalid signature: left bytes after parsing");return{r:o,s:i}},hexFromSig(e){let t=a=>Number.parseInt(a[0],16)&8?"00"+a:a,n=a=>{let l=a.toString(16);return l.length&1?`0${l}`:l},r=t(n(e.s)),o=t(n(e.r)),s=r.length/2,i=o.length/2,c=n(s),f=n(i);return`30${n(i+s+4)}02${f}${o}02${c}${r}`}},It=BigInt(0),ht=BigInt(1),lf=BigInt(2),Yr=BigInt(3),df=BigInt(4);function Ds(e){let t=zs(e),{Fp:n}=t,r=t.toBytes||((p,d,h)=>{let w=d.toAffine();return St(Uint8Array.from([4]),n.toBytes(w.x),n.toBytes(w.y))}),o=t.fromBytes||(p=>{let d=p.subarray(1),h=n.fromBytes(d.subarray(0,n.BYTES)),w=n.fromBytes(d.subarray(n.BYTES,2*n.BYTES));return{x:h,y:w}});function s(p){let{a:d,b:h}=t,w=n.sqr(p),x=n.mul(w,p);return n.add(n.add(x,n.mul(p,d)),h)}if(!n.eql(n.sqr(t.Gy),s(t.Gx)))throw new Error("bad generator point: equation left != right");function i(p){return typeof p=="bigint"&&It<p&&p<t.n}function c(p){if(!i(p))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function f(p){let{allowedPrivateKeyLengths:d,nByteLength:h,wrapPrivateKey:w,n:x}=t;if(d&&typeof p!="bigint"){if(p instanceof Uint8Array&&(p=te(p)),typeof p!="string"||!d.includes(p.length))throw new Error("Invalid key");p=p.padStart(h*2,"0")}let E;try{E=typeof p=="bigint"?p:et(X("private key",p,h))}catch{throw new Error(`private key must be ${h} bytes, hex or bigint, not ${typeof p}`)}return w&&(E=Q(E,x)),c(E),E}let a=new Map;function l(p){if(!(p instanceof u))throw new Error("ProjectivePoint expected")}class u{constructor(d,h,w){if(this.px=d,this.py=h,this.pz=w,d==null||!n.isValid(d))throw new Error("x required");if(h==null||!n.isValid(h))throw new Error("y required");if(w==null||!n.isValid(w))throw new Error("z required")}static fromAffine(d){let{x:h,y:w}=d||{};if(!d||!n.isValid(h)||!n.isValid(w))throw new Error("invalid affine point");if(d instanceof u)throw new Error("projective point not allowed");let x=E=>n.eql(E,n.ZERO);return x(h)&&x(w)?u.ZERO:new u(h,w,n.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(d){let h=n.invertBatch(d.map(w=>w.pz));return d.map((w,x)=>w.toAffine(h[x])).map(u.fromAffine)}static fromHex(d){let h=u.fromAffine(o(X("pointHex",d)));return h.assertValidity(),h}static fromPrivateKey(d){return u.BASE.multiply(f(d))}_setWindowSize(d){this._WINDOW_SIZE=d,a.delete(this)}assertValidity(){if(this.is0()){if(t.allowInfinityPoint&&!n.is0(this.py))return;throw new Error("bad point: ZERO")}let{x:d,y:h}=this.toAffine();if(!n.isValid(d)||!n.isValid(h))throw new Error("bad point: x or y not FE");let w=n.sqr(h),x=s(d);if(!n.eql(w,x))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){let{y:d}=this.toAffine();if(n.isOdd)return!n.isOdd(d);throw new Error("Field doesn't support isOdd")}equals(d){l(d);let{px:h,py:w,pz:x}=this,{px:E,py:L,pz:U}=d,B=n.eql(n.mul(h,U),n.mul(E,x)),A=n.eql(n.mul(w,U),n.mul(L,x));return B&&A}negate(){return new u(this.px,n.neg(this.py),this.pz)}double(){let{a:d,b:h}=t,w=n.mul(h,Yr),{px:x,py:E,pz:L}=this,U=n.ZERO,B=n.ZERO,A=n.ZERO,I=n.mul(x,x),k=n.mul(E,E),_=n.mul(L,L),T=n.mul(x,E);return T=n.add(T,T),A=n.mul(x,L),A=n.add(A,A),U=n.mul(d,A),B=n.mul(w,_),B=n.add(U,B),U=n.sub(k,B),B=n.add(k,B),B=n.mul(U,B),U=n.mul(T,U),A=n.mul(w,A),_=n.mul(d,_),T=n.sub(I,_),T=n.mul(d,T),T=n.add(T,A),A=n.add(I,I),I=n.add(A,I),I=n.add(I,_),I=n.mul(I,T),B=n.add(B,I),_=n.mul(E,L),_=n.add(_,_),I=n.mul(_,T),U=n.sub(U,I),A=n.mul(_,k),A=n.add(A,A),A=n.add(A,A),new u(U,B,A)}add(d){l(d);let{px:h,py:w,pz:x}=this,{px:E,py:L,pz:U}=d,B=n.ZERO,A=n.ZERO,I=n.ZERO,k=t.a,_=n.mul(t.b,Yr),T=n.mul(h,E),q=n.mul(w,L),C=n.mul(x,U),V=n.add(h,w),b=n.add(E,L);V=n.mul(V,b),b=n.add(T,q),V=n.sub(V,b),b=n.add(h,x);let m=n.add(E,U);return b=n.mul(b,m),m=n.add(T,C),b=n.sub(b,m),m=n.add(w,x),B=n.add(L,U),m=n.mul(m,B),B=n.add(q,C),m=n.sub(m,B),I=n.mul(k,b),B=n.mul(_,C),I=n.add(B,I),B=n.sub(q,I),I=n.add(q,I),A=n.mul(B,I),q=n.add(T,T),q=n.add(q,T),C=n.mul(k,C),b=n.mul(_,b),q=n.add(q,C),C=n.sub(T,C),C=n.mul(k,C),b=n.add(b,C),T=n.mul(q,b),A=n.add(A,T),T=n.mul(m,b),B=n.mul(V,B),B=n.sub(B,T),T=n.mul(V,q),I=n.mul(m,I),I=n.add(I,T),new u(B,A,I)}subtract(d){return this.add(d.negate())}is0(){return this.equals(u.ZERO)}wNAF(d){return y.wNAFCached(this,a,d,h=>{let w=n.invertBatch(h.map(x=>x.pz));return h.map((x,E)=>x.toAffine(w[E])).map(u.fromAffine)})}multiplyUnsafe(d){let h=u.ZERO;if(d===It)return h;if(c(d),d===ht)return this;let{endo:w}=t;if(!w)return y.unsafeLadder(this,d);let{k1neg:x,k1:E,k2neg:L,k2:U}=w.splitScalar(d),B=h,A=h,I=this;for(;E>It||U>It;)E&ht&&(B=B.add(I)),U&ht&&(A=A.add(I)),I=I.double(),E>>=ht,U>>=ht;return x&&(B=B.negate()),L&&(A=A.negate()),A=new u(n.mul(A.px,w.beta),A.py,A.pz),B.add(A)}multiply(d){c(d);let h=d,w,x,{endo:E}=t;if(E){let{k1neg:L,k1:U,k2neg:B,k2:A}=E.splitScalar(h),{p:I,f:k}=this.wNAF(U),{p:_,f:T}=this.wNAF(A);I=y.constTimeNegate(L,I),_=y.constTimeNegate(B,_),_=new u(n.mul(_.px,E.beta),_.py,_.pz),w=I.add(_),x=k.add(T)}else{let{p:L,f:U}=this.wNAF(h);w=L,x=U}return u.normalizeZ([w,x])[0]}multiplyAndAddUnsafe(d,h,w){let x=u.BASE,E=(U,B)=>B===It||B===ht||!U.equals(x)?U.multiplyUnsafe(B):U.multiply(B),L=E(this,h).add(E(d,w));return L.is0()?void 0:L}toAffine(d){let{px:h,py:w,pz:x}=this,E=this.is0();d==null&&(d=E?n.ONE:n.inv(x));let L=n.mul(h,d),U=n.mul(w,d),B=n.mul(x,d);if(E)return{x:n.ZERO,y:n.ZERO};if(!n.eql(B,n.ONE))throw new Error("invZ was invalid");return{x:L,y:U}}isTorsionFree(){let{h:d,isTorsionFree:h}=t;if(d===ht)return!0;if(h)return h(u,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){let{h:d,clearCofactor:h}=t;return d===ht?this:h?h(u,this):this.multiplyUnsafe(t.h)}toRawBytes(d=!0){return this.assertValidity(),r(u,this,d)}toHex(d=!0){return te(this.toRawBytes(d))}}u.BASE=new u(t.Gx,t.Gy,n.ONE),u.ZERO=new u(n.ZERO,n.ONE,n.ZERO);let g=t.nBitLength,y=Gr(u,t.endo?Math.ceil(g/2):g);return{CURVE:t,ProjectivePoint:u,normPrivateKeyToScalar:f,weierstrassEquation:s,isWithinCurveOrder:i}}function Ws(e){let t=Cn(e);return Vt(t,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...t})}function Xr(e){let t=Ws(e),{Fp:n,n:r}=t,o=n.BYTES+1,s=2*n.BYTES+1;function i(b){return It<b&&b<n.ORDER}function c(b){return Q(b,r)}function f(b){return Me(b,r)}let{ProjectivePoint:a,normPrivateKeyToScalar:l,weierstrassEquation:u,isWithinCurveOrder:g}=Ds({...t,toBytes(b,m,S){let O=m.toAffine(),v=n.toBytes(O.x),H=St;return S?H(Uint8Array.from([m.hasEvenY()?2:3]),v):H(Uint8Array.from([4]),v,n.toBytes(O.y))},fromBytes(b){let m=b.length,S=b[0],O=b.subarray(1);if(m===o&&(S===2||S===3)){let v=et(O);if(!i(v))throw new Error("Point is not on curve");let H=u(v),$=n.sqrt(H),R=($&ht)===ht;return(S&1)===1!==R&&($=n.neg($)),{x:v,y:$}}else if(m===s&&S===4){let v=n.fromBytes(O.subarray(0,n.BYTES)),H=n.fromBytes(O.subarray(n.BYTES,2*n.BYTES));return{x:v,y:H}}else throw new Error(`Point of length ${m} was invalid. Expected ${o} compressed bytes or ${s} uncompressed bytes`)}}),y=b=>te(bt(b,t.nByteLength));function p(b){let m=r>>ht;return b>m}function d(b){return p(b)?c(-b):b}let h=(b,m,S)=>et(b.slice(m,S));class w{constructor(m,S,O){this.r=m,this.s=S,this.recovery=O,this.assertValidity()}static fromCompact(m){let S=t.nByteLength;return m=X("compactSignature",m,S*2),new w(h(m,0,S),h(m,S,2*S))}static fromDER(m){let{r:S,s:O}=re.toSig(X("DER",m));return new w(S,O)}assertValidity(){if(!g(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!g(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(m){return new w(this.r,this.s,m)}recoverPublicKey(m){let{r:S,s:O,recovery:v}=this,H=A(X("msgHash",m));if(v==null||![0,1,2,3].includes(v))throw new Error("recovery id invalid");let $=v===2||v===3?S+t.n:S;if($>=n.ORDER)throw new Error("recovery id 2 or 3 invalid");let R=v&1?"03":"02",P=a.fromHex(R+y($)),z=f($),Y=c(-H*z),tt=c(O*z),Z=a.BASE.multiplyAndAddUnsafe(P,Y,tt);if(!Z)throw new Error("point at infinify");return Z.assertValidity(),Z}hasHighS(){return p(this.s)}normalizeS(){return this.hasHighS()?new w(this.r,c(-this.s),this.recovery):this}toDERRawBytes(){return ee(this.toDERHex())}toDERHex(){return re.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return ee(this.toCompactHex())}toCompactHex(){return y(this.r)+y(this.s)}}let x={isValidPrivateKey(b){try{return l(b),!0}catch{return!1}},normPrivateKeyToScalar:l,randomPrivateKey:()=>{let b=kn(t.n);return Wr(t.randomBytes(b),t.n)},precompute(b=8,m=a.BASE){return m._setWindowSize(b),m.multiply(BigInt(3)),m}};function E(b,m=!0){return a.fromPrivateKey(b).toRawBytes(m)}function L(b){let m=b instanceof Uint8Array,S=typeof b=="string",O=(m||S)&&b.length;return m?O===o||O===s:S?O===2*o||O===2*s:b instanceof a}function U(b,m,S=!0){if(L(b))throw new Error("first arg must be private key");if(!L(m))throw new Error("second arg must be public key");return a.fromHex(m).multiply(l(b)).toRawBytes(S)}let B=t.bits2int||function(b){let m=et(b),S=b.length*8-t.nBitLength;return S>0?m>>BigInt(S):m},A=t.bits2int_modN||function(b){return c(B(b))},I=Ue(t.nBitLength);function k(b){if(typeof b!="bigint")throw new Error("bigint expected");if(!(It<=b&&b<I))throw new Error(`bigint expected < 2^${t.nBitLength}`);return bt(b,t.nByteLength)}function _(b,m,S=T){if(["recovered","canonical"].some(D=>D in S))throw new Error("sign() legacy options not supported");let{hash:O,randomBytes:v}=t,{lowS:H,prehash:$,extraEntropy:R}=S;H==null&&(H=!0),b=X("msgHash",b),$&&(b=X("prehashed msgHash",O(b)));let P=A(b),z=l(m),Y=[k(z),k(P)];if(R!=null){let D=R===!0?v(n.BYTES):R;Y.push(X("extraEntropy",D))}let tt=St(...Y),Z=P;function st(D){let it=B(D);if(!g(it))return;let Ae=f(it),ct=a.BASE.multiply(it).toAffine(),M=c(ct.x);if(M===It)return;let ft=c(Ae*c(Z+M*z));if(ft===It)return;let Le=(ct.x===M?0:2)|Number(ct.y&ht),Se=ft;return H&&p(ft)&&(Se=d(ft),Le^=1),new w(M,Se,Le)}return{seed:tt,k2sig:st}}let T={lowS:t.lowS,prehash:!1},q={lowS:t.lowS,prehash:!1};function C(b,m,S=T){let{seed:O,k2sig:v}=_(b,m,S),H=t;return Tn(H.hash.outputLen,H.nByteLength,H.hmac)(O,v)}a.BASE._setWindowSize(8);function V(b,m,S,O=q){var ct;let v=b;if(m=X("msgHash",m),S=X("publicKey",S),"strict"in O)throw new Error("options.strict was renamed to lowS");let{lowS:H,prehash:$}=O,R,P;try{if(typeof v=="string"||v instanceof Uint8Array)try{R=w.fromDER(v)}catch(M){if(!(M instanceof re.Err))throw M;R=w.fromCompact(v)}else if(typeof v=="object"&&typeof v.r=="bigint"&&typeof v.s=="bigint"){let{r:M,s:ft}=v;R=new w(M,ft)}else throw new Error("PARSE");P=a.fromHex(S)}catch(M){if(M.message==="PARSE")throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(H&&R.hasHighS())return!1;$&&(m=t.hash(m));let{r:z,s:Y}=R,tt=A(m),Z=f(Y),st=c(tt*Z),D=c(z*Z),it=(ct=a.BASE.multiplyAndAddUnsafe(P,st,D))==null?void 0:ct.toAffine();return it?c(it.x)===z:!1}return{CURVE:t,getPublicKey:E,getSharedSecret:U,sign:C,verify:V,ProjectivePoint:a,Signature:w,utils:x}}var De=class extends le{constructor(t,n){super(),this.finished=!1,this.destroyed=!1,qr(t);let r=Ie(n);if(this.iHash=t.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let o=this.blockLen,s=new Uint8Array(o);s.set(r.length>o?t.create().update(r).digest():r);for(let i=0;i<s.length;i++)s[i]^=54;this.iHash.update(s),this.oHash=t.create();for(let i=0;i<s.length;i++)s[i]^=106;this.oHash.update(s),s.fill(0)}update(t){return ue(this),this.iHash.update(t),this}digestInto(t){ue(this),Ln(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){let t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));let{oHash:n,iHash:r,finished:o,destroyed:s,blockLen:i,outputLen:c}=this;return t=t,t.finished=o,t.destroyed=s,t.blockLen=i,t.outputLen=c,t.oHash=n._cloneInto(t.oHash),t.iHash=r._cloneInto(t.iHash),t}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}},Rn=(e,t,n)=>new De(e,t).update(n).digest();Rn.create=(e,t)=>new De(e,t);function Gs(e){return{hash:e,hmac:(t,...n)=>Rn(e,t,$r(...n)),randomBytes:$e}}function Qr(e,t){let n=r=>Xr({...e,...Gs(r)});return Object.freeze({...n(t),create:n})}var Xe=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),We=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),to=BigInt(1),Ge=BigInt(2),Jr=(e,t)=>(e+t/Ge)/t;function eo(e){let t=Xe,n=BigInt(3),r=BigInt(6),o=BigInt(11),s=BigInt(22),i=BigInt(23),c=BigInt(44),f=BigInt(88),a=e*e*e%t,l=a*a*e%t,u=at(l,n,t)*l%t,g=at(u,n,t)*l%t,y=at(g,Ge,t)*a%t,p=at(y,o,t)*y%t,d=at(p,s,t)*p%t,h=at(d,c,t)*d%t,w=at(h,f,t)*h%t,x=at(w,c,t)*d%t,E=at(x,n,t)*l%t,L=at(E,i,t)*p%t,U=at(L,r,t)*a%t,B=at(U,Ge,t);if(!Vn.eql(Vn.sqr(B),e))throw new Error("Cannot find square root");return B}var Vn=Mr(Xe,void 0,void 0,{sqrt:eo}),Kt=Qr({a:BigInt(0),b:BigInt(7),Fp:Vn,n:We,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:e=>{let t=We,n=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),r=-to*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),o=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),s=n,i=BigInt("0x100000000000000000000000000000000"),c=Jr(s*e,t),f=Jr(-r*e,t),a=Q(e-c*n-f*o,t),l=Q(-c*r-f*s,t),u=a>i,g=l>i;if(u&&(a=t-a),g&&(l=t-l),a>i||l>i)throw new Error("splitScalar: Endomorphism failed, k="+e);return{k1neg:u,k1:a,k2neg:g,k2:l}}}},Ke),Qe=BigInt(0),no=e=>typeof e=="bigint"&&Qe<e&&e<Xe,Ys=e=>typeof e=="bigint"&&Qe<e&&e<We,Fr={};function Ye(e,...t){let n=Fr[e];if(n===void 0){let r=Ke(Uint8Array.from(e,o=>o.charCodeAt(0)));n=St(r,r),Fr[e]=n}return Ke(St(n,...t))}var Pn=e=>e.toRawBytes(!0).slice(1),Kn=e=>bt(e,32),$n=e=>Q(e,Xe),Te=e=>Q(e,We),zn=Kt.ProjectivePoint,Xs=(e,t,n)=>zn.BASE.multiplyAndAddUnsafe(e,t,n);function jn(e){let t=Kt.utils.normPrivateKeyToScalar(e),n=zn.fromPrivateKey(t);return{scalar:n.hasEvenY()?t:Te(-t),bytes:Pn(n)}}function ro(e){if(!no(e))throw new Error("bad x: need 0 < x < p");let t=$n(e*e),n=$n(t*e+BigInt(7)),r=eo(n);r%Ge!==Qe&&(r=$n(-r));let o=new zn(e,r,to);return o.assertValidity(),o}function oo(...e){return Te(et(Ye("BIP0340/challenge",...e)))}function Qs(e){return jn(e).bytes}function Js(e,t,n=$e(32)){let r=X("message",e),{bytes:o,scalar:s}=jn(t),i=X("auxRand",n,32),c=Kn(s^et(Ye("BIP0340/aux",i))),f=Ye("BIP0340/nonce",c,o,r),a=Te(et(f));if(a===Qe)throw new Error("sign failed: k is zero");let{bytes:l,scalar:u}=jn(a),g=oo(l,o,r),y=new Uint8Array(64);if(y.set(l,0),y.set(Kn(Te(u+g*s)),32),!so(y,r,o))throw new Error("sign: Invalid signature produced");return y}function so(e,t,n){let r=X("signature",e,64),o=X("message",t),s=X("publicKey",n,32);try{let i=ro(et(s)),c=et(r.subarray(0,32));if(!no(c))return!1;let f=et(r.subarray(32,64));if(!Ys(f))return!1;let a=oo(Kn(c),Pn(i),o),l=Xs(i,f,Te(-a));return!(!l||!l.hasEvenY()||l.toAffine().x!==c)}catch{return!1}}var de={getPublicKey:Qs,sign:Js,verify:so,utils:{randomPrivateKey:Kt.utils.randomPrivateKey,lift_x:ro,pointToBytes:Pn,numberToBytesBE:bt,bytesToNumberBE:et,taggedHash:Ye,mod:Q}};var Je=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;var Zn=e=>e instanceof Uint8Array;var Fe=e=>new DataView(e.buffer,e.byteOffset,e.byteLength),xt=(e,t)=>e<<32-t|e>>>t,Fs=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!Fs)throw new Error("Non little-endian hardware is not supported");var ti=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function Ut(e){if(!Zn(e))throw new Error("Uint8Array expected");let t="";for(let n=0;n<e.length;n++)t+=ti[e[n]];return t}function io(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);let t=e.length;if(t%2)throw new Error("padded hex string expected, got unpadded hex of length "+t);let n=new Uint8Array(t/2);for(let r=0;r<n.length;r++){let o=r*2,s=e.slice(o,o+2),i=Number.parseInt(s,16);if(Number.isNaN(i)||i<0)throw new Error("Invalid byte sequence");n[r]=i}return n}function ei(e){if(typeof e!="string")throw new Error(`utf8ToBytes expected string, got ${typeof e}`);return new Uint8Array(new TextEncoder().encode(e))}function jt(e){if(typeof e=="string"&&(e=ei(e)),!Zn(e))throw new Error(`expected Uint8Array, got ${typeof e}`);return e}function _e(...e){let t=new Uint8Array(e.reduce((r,o)=>r+o.length,0)),n=0;return e.forEach(r=>{if(!Zn(r))throw new Error("Uint8Array expected");t.set(r,n),n+=r.length}),t}var he=class{clone(){return this._cloneInto()}};function Mn(e){let t=r=>e().update(jt(r)).digest(),n=e();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=()=>e(),t}function tn(e=32){if(Je&&typeof Je.getRandomValues=="function")return Je.getRandomValues(new Uint8Array(e));throw new Error("crypto.getRandomValues must be defined")}function Dn(e){if(!Number.isSafeInteger(e)||e<0)throw new Error(`Wrong positive integer: ${e}`)}function ni(e){if(typeof e!="boolean")throw new Error(`Expected boolean, not ${e}`)}function co(e,...t){if(!(e instanceof Uint8Array))throw new Error("Expected Uint8Array");if(t.length>0&&!t.includes(e.length))throw new Error(`Expected Uint8Array of length ${t}, not of length=${e.length}`)}function ri(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");Dn(e.outputLen),Dn(e.blockLen)}function oi(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function si(e,t){co(e);let n=t.outputLen;if(e.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}var ii={number:Dn,bool:ni,bytes:co,hash:ri,exists:oi,output:si},ut=ii;function ci(e,t,n,r){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,n,r);let o=BigInt(32),s=BigInt(4294967295),i=Number(n>>o&s),c=Number(n&s),f=r?4:0,a=r?0:4;e.setUint32(t+f,i,r),e.setUint32(t+a,c,r)}var en=class extends he{constructor(t,n,r,o){super(),this.blockLen=t,this.outputLen=n,this.padOffset=r,this.isLE=o,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=Fe(this.buffer)}update(t){ut.exists(this);let{view:n,buffer:r,blockLen:o}=this;t=jt(t);let s=t.length;for(let i=0;i<s;){let c=Math.min(o-this.pos,s-i);if(c===o){let f=Fe(t);for(;o<=s-i;i+=o)this.process(f,i);continue}r.set(t.subarray(i,i+c),this.pos),this.pos+=c,i+=c,this.pos===o&&(this.process(n,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){ut.exists(this),ut.output(t,this),this.finished=!0;let{buffer:n,view:r,blockLen:o,isLE:s}=this,{pos:i}=this;n[i++]=128,this.buffer.subarray(i).fill(0),this.padOffset>o-i&&(this.process(r,0),i=0);for(let u=i;u<o;u++)n[u]=0;ci(r,o-8,BigInt(this.length*8),s),this.process(r,0);let c=Fe(t),f=this.outputLen;if(f%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let a=f/4,l=this.get();if(a>l.length)throw new Error("_sha2: outputLen bigger than state");for(let u=0;u<a;u++)c.setUint32(4*u,l[u],s)}digest(){let{buffer:t,outputLen:n}=this;this.digestInto(t);let r=t.slice(0,n);return this.destroy(),r}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());let{blockLen:n,buffer:r,length:o,finished:s,destroyed:i,pos:c}=this;return t.length=o,t.pos=c,t.finished=s,t.destroyed=i,o%n&&t.buffer.set(r),t}};var fi=(e,t,n)=>e&t^~e&n,ai=(e,t,n)=>e&t^e&n^t&n,ui=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Pt=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),zt=new Uint32Array(64),nn=class extends en{constructor(){super(64,32,8,!1),this.A=Pt[0]|0,this.B=Pt[1]|0,this.C=Pt[2]|0,this.D=Pt[3]|0,this.E=Pt[4]|0,this.F=Pt[5]|0,this.G=Pt[6]|0,this.H=Pt[7]|0}get(){let{A:t,B:n,C:r,D:o,E:s,F:i,G:c,H:f}=this;return[t,n,r,o,s,i,c,f]}set(t,n,r,o,s,i,c,f){this.A=t|0,this.B=n|0,this.C=r|0,this.D=o|0,this.E=s|0,this.F=i|0,this.G=c|0,this.H=f|0}process(t,n){for(let u=0;u<16;u++,n+=4)zt[u]=t.getUint32(n,!1);for(let u=16;u<64;u++){let g=zt[u-15],y=zt[u-2],p=xt(g,7)^xt(g,18)^g>>>3,d=xt(y,17)^xt(y,19)^y>>>10;zt[u]=d+zt[u-7]+p+zt[u-16]|0}let{A:r,B:o,C:s,D:i,E:c,F:f,G:a,H:l}=this;for(let u=0;u<64;u++){let g=xt(c,6)^xt(c,11)^xt(c,25),y=l+g+fi(c,f,a)+ui[u]+zt[u]|0,d=(xt(r,2)^xt(r,13)^xt(r,22))+ai(r,o,s)|0;l=a,a=f,f=c,c=i+y|0,i=s,s=o,o=r,r=y+d|0}r=r+this.A|0,o=o+this.B|0,s=s+this.C|0,i=i+this.D|0,c=c+this.E|0,f=f+this.F|0,a=a+this.G|0,l=l+this.H|0,this.set(r,o,s,i,c,f,a,l)}roundClean(){zt.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}},Wn=class extends nn{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}},pe=Mn(()=>new nn),Cf=Mn(()=>new Wn);var ge=Symbol("verified"),li=e=>e instanceof Object;function di(e){if(!li(e)||typeof e.kind!="number"||typeof e.content!="string"||typeof e.created_at!="number"||typeof e.pubkey!="string"||!e.pubkey.match(/^[a-f0-9]{64}$/)||!Array.isArray(e.tags))return!1;for(let t=0;t<e.tags.length;t++){let n=e.tags[t];if(!Array.isArray(n))return!1;for(let r=0;r<n.length;r++)if(typeof n[r]=="object")return!1}return!0}var jf=new TextDecoder("utf-8"),hi=new TextEncoder,pi=class{generateSecretKey(){return de.utils.randomPrivateKey()}getPublicKey(e){return Ut(de.getPublicKey(e))}finalizeEvent(e,t){let n=e;return n.pubkey=Ut(de.getPublicKey(t)),n.id=Gn(n),n.sig=Ut(de.sign(Gn(n),t)),n[ge]=!0,n}verifyEvent(e){if(typeof e[ge]=="boolean")return e[ge];let t=Gn(e);if(t!==e.id)return e[ge]=!1,!1;try{let n=de.verify(e.sig,t,e.pubkey);return e[ge]=n,n}catch{return e[ge]=!1,!1}}};function gi(e){if(!di(e))throw new Error("can't serialize event with wrong or missing properties");return JSON.stringify([0,e.pubkey,e.created_at,e.kind,e.tags,e.content])}function Gn(e){let t=pe(hi.encode(gi(e)));return Ut(t)}var rn=new pi,Pf=rn.generateSecretKey,fo=rn.getPublicKey,zf=rn.finalizeEvent,Zf=rn.verifyEvent;var Oo={};An(Oo,{decrypt:()=>$i,encrypt:()=>Ri});function on(e){if(!Number.isSafeInteger(e)||e<0)throw new Error(`positive integer expected, not ${e}`)}function Yn(e){if(typeof e!="boolean")throw new Error(`boolean expected, not ${e}`)}function Xn(e){return e instanceof Uint8Array||e!=null&&typeof e=="object"&&e.constructor.name==="Uint8Array"}function K(e,...t){if(!Xn(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error(`Uint8Array expected of length ${t}, not of length=${e.length}`)}function Zt(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function Oe(e,t){K(e);let n=t.outputLen;if(e.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}var sn=e=>new Uint8Array(e.buffer,e.byteOffset,e.byteLength);var j=e=>new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4)),Mt=e=>new DataView(e.buffer,e.byteOffset,e.byteLength),wi=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!wi)throw new Error("Non little-endian hardware is not supported");function yi(e){if(typeof e!="string")throw new Error(`string expected, got ${typeof e}`);return new Uint8Array(new TextEncoder().encode(e))}function Bt(e){if(typeof e=="string")e=yi(e);else if(Xn(e))e=e.slice();else throw new Error(`Uint8Array expected, got ${typeof e}`);return e}function ao(e,t){if(t==null||typeof t!="object")throw new Error("options must be defined");return Object.assign(e,t)}function oe(e,t){if(e.length!==t.length)return!1;let n=0;for(let r=0;r<e.length;r++)n|=e[r]^t[r];return n===0}var vt=(e,t)=>(Object.assign(t,e),t);function se(e,t,n,r){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,n,r);let o=BigInt(32),s=BigInt(4294967295),i=Number(n>>o&s),c=Number(n&s),f=r?4:0,a=r?0:4;e.setUint32(t+f,i,r),e.setUint32(t+a,c,r)}var Tt=16,Jn=new Uint8Array(16),At=j(Jn),bi=225,xi=(e,t,n,r)=>{let o=r&1;return{s3:n<<31|r>>>1,s2:t<<31|n>>>1,s1:e<<31|t>>>1,s0:e>>>1^bi<<24&-(o&1)}},pt=e=>(e>>>0&255)<<24|(e>>>8&255)<<16|(e>>>16&255)<<8|e>>>24&255|0;function mi(e){e.reverse();let t=e[15]&1,n=0;for(let r=0;r<e.length;r++){let o=e[r];e[r]=o>>>1|n,n=(o&1)<<7}return e[0]^=-t&225,e}var Ei=e=>e>64*1024?8:e>1024?4:2,cn=class{constructor(t,n){this.blockLen=Tt,this.outputLen=Tt,this.s0=0,this.s1=0,this.s2=0,this.s3=0,this.finished=!1,t=Bt(t),K(t,16);let r=Mt(t),o=r.getUint32(0,!1),s=r.getUint32(4,!1),i=r.getUint32(8,!1),c=r.getUint32(12,!1),f=[];for(let p=0;p<128;p++)f.push({s0:pt(o),s1:pt(s),s2:pt(i),s3:pt(c)}),{s0:o,s1:s,s2:i,s3:c}=xi(o,s,i,c);let a=Ei(n||1024);if(![1,2,4,8].includes(a))throw new Error(`ghash: wrong window size=${a}, should be 2, 4 or 8`);this.W=a;let u=128/a,g=this.windowSize=2**a,y=[];for(let p=0;p<u;p++)for(let d=0;d<g;d++){let h=0,w=0,x=0,E=0;for(let L=0;L<a;L++){if(!(d>>>a-L-1&1))continue;let{s0:B,s1:A,s2:I,s3:k}=f[a*p+L];h^=B,w^=A,x^=I,E^=k}y.push({s0:h,s1:w,s2:x,s3:E})}this.t=y}_updateBlock(t,n,r,o){t^=this.s0,n^=this.s1,r^=this.s2,o^=this.s3;let{W:s,t:i,windowSize:c}=this,f=0,a=0,l=0,u=0,g=(1<<s)-1,y=0;for(let p of[t,n,r,o])for(let d=0;d<4;d++){let h=p>>>8*d&255;for(let w=8/s-1;w>=0;w--){let x=h>>>s*w&g,{s0:E,s1:L,s2:U,s3:B}=i[y*c+x];f^=E,a^=L,l^=U,u^=B,y+=1}}this.s0=f,this.s1=a,this.s2=l,this.s3=u}update(t){t=Bt(t),Zt(this);let n=j(t),r=Math.floor(t.length/Tt),o=t.length%Tt;for(let s=0;s<r;s++)this._updateBlock(n[s*4+0],n[s*4+1],n[s*4+2],n[s*4+3]);return o&&(Jn.set(t.subarray(r*Tt)),this._updateBlock(At[0],At[1],At[2],At[3]),At.fill(0)),this}destroy(){let{t}=this;for(let n of t)n.s0=0,n.s1=0,n.s2=0,n.s3=0}digestInto(t){Zt(this),Oe(t,this),this.finished=!0;let{s0:n,s1:r,s2:o,s3:s}=this,i=j(t);return i[0]=n,i[1]=r,i[2]=o,i[3]=s,t}digest(){let t=new Uint8Array(Tt);return this.digestInto(t),this.destroy(),t}},Qn=class extends cn{constructor(t,n){t=Bt(t);let r=mi(t.slice());super(r,n),r.fill(0)}update(t){t=Bt(t),Zt(this);let n=j(t),r=t.length%Tt,o=Math.floor(t.length/Tt);for(let s=0;s<o;s++)this._updateBlock(pt(n[s*4+3]),pt(n[s*4+2]),pt(n[s*4+1]),pt(n[s*4+0]));return r&&(Jn.set(t.subarray(o*Tt)),this._updateBlock(pt(At[3]),pt(At[2]),pt(At[1]),pt(At[0])),At.fill(0)),this}digestInto(t){Zt(this),Oe(t,this),this.finished=!0;let{s0:n,s1:r,s2:o,s3:s}=this,i=j(t);return i[0]=n,i[1]=r,i[2]=o,i[3]=s,t.reverse()}};function uo(e){let t=(r,o)=>e(o,r.length).update(Bt(r)).digest(),n=e(new Uint8Array(16),0);return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=(r,o)=>e(r,o),t}var Fn=uo((e,t)=>new cn(e,t)),lo=uo((e,t)=>new Qn(e,t));var ot=16,nr=4,fn=new Uint8Array(ot),Bi=283;function rr(e){return e<<1^Bi&-(e>>7)}function we(e,t){let n=0;for(;t>0;t>>=1)n^=e&-(t&1),e=rr(e);return n}var er=(()=>{let e=new Uint8Array(256);for(let n=0,r=1;n<256;n++,r^=rr(r))e[n]=r;let t=new Uint8Array(256);t[0]=99;for(let n=0;n<255;n++){let r=e[255-n];r|=r<<8,t[e[n]]=(r^r>>4^r>>5^r>>6^r>>7^99)&255}return t})(),vi=er.map((e,t)=>er.indexOf(t)),Ai=e=>e<<24|e>>>8,tr=e=>e<<8|e>>>24;function ho(e,t){if(e.length!==256)throw new Error("Wrong sbox length");let n=new Uint32Array(256).map((a,l)=>t(e[l])),r=n.map(tr),o=r.map(tr),s=o.map(tr),i=new Uint32Array(256*256),c=new Uint32Array(256*256),f=new Uint16Array(256*256);for(let a=0;a<256;a++)for(let l=0;l<256;l++){let u=a*256+l;i[u]=n[a]^r[l],c[u]=o[a]^s[l],f[u]=e[a]<<8|e[l]}return{sbox:e,sbox2:f,T0:n,T1:r,T2:o,T3:s,T01:i,T23:c}}var or=ho(er,e=>we(e,3)<<24|e<<16|e<<8|we(e,2)),po=ho(vi,e=>we(e,11)<<24|we(e,13)<<16|we(e,9)<<8|we(e,14)),Li=(()=>{let e=new Uint8Array(16);for(let t=0,n=1;t<16;t++,n=rr(n))e[t]=n;return e})();function Wt(e){K(e);let t=e.length;if(![16,24,32].includes(t))throw new Error(`aes: wrong key size: should be 16, 24 or 32, got: ${t}`);let{sbox2:n}=or,r=j(e),o=r.length,s=c=>Lt(n,c,c,c,c),i=new Uint32Array(t+28);i.set(r);for(let c=o;c<i.length;c++){let f=i[c-1];c%o===0?f=s(Ai(f))^Li[c/o-1]:o>6&&c%o===4&&(f=s(f)),i[c]=i[c-o]^f}return i}function go(e){let t=Wt(e),n=t.slice(),r=t.length,{sbox2:o}=or,{T0:s,T1:i,T2:c,T3:f}=po;for(let a=0;a<r;a+=4)for(let l=0;l<4;l++)n[a+l]=t[r-a-4+l];t.fill(0);for(let a=4;a<r-4;a++){let l=n[a],u=Lt(o,l,l,l,l);n[a]=s[u&255]^i[u>>>8&255]^c[u>>>16&255]^f[u>>>24]}return n}function Dt(e,t,n,r,o,s){return e[n<<8&65280|r>>>8&255]^t[o>>>8&65280|s>>>24&255]}function Lt(e,t,n,r,o){return e[t&255|n&65280]|e[r>>>16&255|o>>>16&65280]<<16}function gt(e,t,n,r,o){let{sbox2:s,T01:i,T23:c}=or,f=0;t^=e[f++],n^=e[f++],r^=e[f++],o^=e[f++];let a=e.length/4-2;for(let p=0;p<a;p++){let d=e[f++]^Dt(i,c,t,n,r,o),h=e[f++]^Dt(i,c,n,r,o,t),w=e[f++]^Dt(i,c,r,o,t,n),x=e[f++]^Dt(i,c,o,t,n,r);t=d,n=h,r=w,o=x}let l=e[f++]^Lt(s,t,n,r,o),u=e[f++]^Lt(s,n,r,o,t),g=e[f++]^Lt(s,r,o,t,n),y=e[f++]^Lt(s,o,t,n,r);return{s0:l,s1:u,s2:g,s3:y}}function wo(e,t,n,r,o){let{sbox2:s,T01:i,T23:c}=po,f=0;t^=e[f++],n^=e[f++],r^=e[f++],o^=e[f++];let a=e.length/4-2;for(let p=0;p<a;p++){let d=e[f++]^Dt(i,c,t,o,r,n),h=e[f++]^Dt(i,c,n,t,o,r),w=e[f++]^Dt(i,c,r,n,t,o),x=e[f++]^Dt(i,c,o,r,n,t);t=d,n=h,r=w,o=x}let l=e[f++]^Lt(s,t,o,r,n),u=e[f++]^Lt(s,n,t,o,r),g=e[f++]^Lt(s,r,n,t,o),y=e[f++]^Lt(s,o,r,n,t);return{s0:l,s1:u,s2:g,s3:y}}function ye(e,t){if(!t)return new Uint8Array(e);if(K(t),t.length<e)throw new Error(`aes: wrong destination length, expected at least ${e}, got: ${t.length}`);return t}function Si(e,t,n,r){K(t,ot),K(n);let o=n.length;r=ye(o,r);let s=t,i=j(s),{s0:c,s1:f,s2:a,s3:l}=gt(e,i[0],i[1],i[2],i[3]),u=j(n),g=j(r);for(let p=0;p+4<=u.length;p+=4){g[p+0]=u[p+0]^c,g[p+1]=u[p+1]^f,g[p+2]=u[p+2]^a,g[p+3]=u[p+3]^l;let d=1;for(let h=s.length-1;h>=0;h--)d=d+(s[h]&255)|0,s[h]=d&255,d>>>=8;({s0:c,s1:f,s2:a,s3:l}=gt(e,i[0],i[1],i[2],i[3]))}let y=ot*Math.floor(u.length/nr);if(y<o){let p=new Uint32Array([c,f,a,l]),d=sn(p);for(let h=y,w=0;h<o;h++,w++)r[h]=n[h]^d[w]}return r}function Ne(e,t,n,r,o){K(n,ot),K(r),o=ye(r.length,o);let s=n,i=j(s),c=Mt(s),f=j(r),a=j(o),l=t?0:12,u=r.length,g=c.getUint32(l,t),{s0:y,s1:p,s2:d,s3:h}=gt(e,i[0],i[1],i[2],i[3]);for(let x=0;x+4<=f.length;x+=4)a[x+0]=f[x+0]^y,a[x+1]=f[x+1]^p,a[x+2]=f[x+2]^d,a[x+3]=f[x+3]^h,g=g+1>>>0,c.setUint32(l,g,t),{s0:y,s1:p,s2:d,s3:h}=gt(e,i[0],i[1],i[2],i[3]);let w=ot*Math.floor(f.length/nr);if(w<u){let x=new Uint32Array([y,p,d,h]),E=sn(x);for(let L=w,U=0;L<u;L++,U++)o[L]=r[L]^E[U]}return o}var na=vt({blockSize:16,nonceLength:16},function(t,n){K(t),K(n,ot);function r(o,s){let i=Wt(t),c=n.slice(),f=Si(i,c,o,s);return i.fill(0),c.fill(0),f}return{encrypt:(o,s)=>r(o,s),decrypt:(o,s)=>r(o,s)}});function yo(e){if(K(e),e.length%ot!==0)throw new Error(`aes/(cbc-ecb).decrypt ciphertext should consist of blocks with size ${ot}`)}function bo(e,t,n){let r=e.length,o=r%ot;if(!t&&o!==0)throw new Error("aec/(cbc-ecb): unpadded plaintext with disabled padding");let s=j(e);if(t){let f=ot-o;f||(f=ot),r=r+f}let i=ye(r,n),c=j(i);return{b:s,o:c,out:i}}function xo(e,t){if(!t)return e;let n=e.length;if(!n)throw new Error("aes/pcks5: empty ciphertext not allowed");let r=e[n-1];if(r<=0||r>16)throw new Error(`aes/pcks5: wrong padding byte: ${r}`);let o=e.subarray(0,-r);for(let s=0;s<r;s++)if(e[n-s-1]!==r)throw new Error("aes/pcks5: wrong padding");return o}function mo(e){let t=new Uint8Array(16),n=j(t);t.set(e);let r=ot-e.length;for(let o=ot-r;o<ot;o++)t[o]=r;return n}var ra=vt({blockSize:16},function(t,n={}){K(t);let r=!n.disablePadding;return{encrypt:(o,s)=>{K(o);let{b:i,o:c,out:f}=bo(o,r,s),a=Wt(t),l=0;for(;l+4<=i.length;){let{s0:u,s1:g,s2:y,s3:p}=gt(a,i[l+0],i[l+1],i[l+2],i[l+3]);c[l++]=u,c[l++]=g,c[l++]=y,c[l++]=p}if(r){let u=mo(o.subarray(l*4)),{s0:g,s1:y,s2:p,s3:d}=gt(a,u[0],u[1],u[2],u[3]);c[l++]=g,c[l++]=y,c[l++]=p,c[l++]=d}return a.fill(0),f},decrypt:(o,s)=>{yo(o);let i=go(t),c=ye(o.length,s),f=j(o),a=j(c);for(let l=0;l+4<=f.length;){let{s0:u,s1:g,s2:y,s3:p}=wo(i,f[l+0],f[l+1],f[l+2],f[l+3]);a[l++]=u,a[l++]=g,a[l++]=y,a[l++]=p}return i.fill(0),xo(c,r)}}}),sr=vt({blockSize:16,nonceLength:16},function(t,n,r={}){K(t),K(n,16);let o=!r.disablePadding;return{encrypt:(s,i)=>{let c=Wt(t),{b:f,o:a,out:l}=bo(s,o,i),u=j(n),g=u[0],y=u[1],p=u[2],d=u[3],h=0;for(;h+4<=f.length;)g^=f[h+0],y^=f[h+1],p^=f[h+2],d^=f[h+3],{s0:g,s1:y,s2:p,s3:d}=gt(c,g,y,p,d),a[h++]=g,a[h++]=y,a[h++]=p,a[h++]=d;if(o){let w=mo(s.subarray(h*4));g^=w[0],y^=w[1],p^=w[2],d^=w[3],{s0:g,s1:y,s2:p,s3:d}=gt(c,g,y,p,d),a[h++]=g,a[h++]=y,a[h++]=p,a[h++]=d}return c.fill(0),l},decrypt:(s,i)=>{yo(s);let c=go(t),f=j(n),a=ye(s.length,i),l=j(s),u=j(a),g=f[0],y=f[1],p=f[2],d=f[3];for(let h=0;h+4<=l.length;){let w=g,x=y,E=p,L=d;g=l[h+0],y=l[h+1],p=l[h+2],d=l[h+3];let{s0:U,s1:B,s2:A,s3:I}=wo(c,g,y,p,d);u[h++]=U^w,u[h++]=B^x,u[h++]=A^E,u[h++]=I^L}return c.fill(0),xo(a,o)}}}),oa=vt({blockSize:16,nonceLength:16},function(t,n){K(t),K(n,16);function r(o,s,i){let c=Wt(t),f=o.length;i=ye(f,i);let a=j(o),l=j(i),u=s?l:a,g=j(n),y=g[0],p=g[1],d=g[2],h=g[3];for(let x=0;x+4<=a.length;){let{s0:E,s1:L,s2:U,s3:B}=gt(c,y,p,d,h);l[x+0]=a[x+0]^E,l[x+1]=a[x+1]^L,l[x+2]=a[x+2]^U,l[x+3]=a[x+3]^B,y=u[x++],p=u[x++],d=u[x++],h=u[x++]}let w=ot*Math.floor(a.length/nr);if(w<f){({s0:y,s1:p,s2:d,s3:h}=gt(c,y,p,d,h));let x=sn(new Uint32Array([y,p,d,h]));for(let E=w,L=0;E<f;E++,L++)i[E]=o[E]^x[L];x.fill(0)}return c.fill(0),i}return{encrypt:(o,s)=>r(o,!0,s),decrypt:(o,s)=>r(o,!1,s)}});function Eo(e,t,n,r,o){let s=e.create(n,r.length+((o==null?void 0:o.length)||0));o&&s.update(o),s.update(r);let i=new Uint8Array(16),c=Mt(i);return o&&se(c,0,BigInt(o.length*8),t),se(c,8,BigInt(r.length*8),t),s.update(i),s.digest()}var sa=vt({blockSize:16,nonceLength:12,tagLength:16},function(t,n,r){if(K(n),n.length===0)throw new Error("aes/gcm: empty nonce");let o=16;function s(c,f,a){let l=Eo(Fn,!1,c,a,r);for(let u=0;u<f.length;u++)l[u]^=f[u];return l}function i(){let c=Wt(t),f=fn.slice(),a=fn.slice();if(Ne(c,!1,a,a,f),n.length===12)a.set(n);else{let u=fn.slice(),g=Mt(u);se(g,8,BigInt(n.length*8),!1),Fn.create(f).update(n).update(u).digestInto(a)}let l=Ne(c,!1,a,fn);return{xk:c,authKey:f,counter:a,tagMask:l}}return{encrypt:c=>{K(c);let{xk:f,authKey:a,counter:l,tagMask:u}=i(),g=new Uint8Array(c.length+o);Ne(f,!1,l,c,g);let y=s(a,u,g.subarray(0,g.length-o));return g.set(y,c.length),f.fill(0),g},decrypt:c=>{if(K(c),c.length<o)throw new Error(`aes/gcm: ciphertext less than tagLen (${o})`);let{xk:f,authKey:a,counter:l,tagMask:u}=i(),g=c.subarray(0,-o),y=c.subarray(-o),p=s(a,u,g);if(!oe(p,y))throw new Error("aes/gcm: invalid ghash tag");let d=Ne(f,!1,l,g);return a.fill(0),u.fill(0),f.fill(0),d}}}),an=(e,t,n)=>r=>{if(!Number.isSafeInteger(r)||t>r||r>n)throw new Error(`${e}: invalid value=${r}, must be [${t}..${n}]`)},ia=vt({blockSize:16,nonceLength:12,tagLength:16},function(t,n,r){let s=an("AAD",0,68719476736),i=an("plaintext",0,2**36),c=an("nonce",12,12),f=an("ciphertext",16,2**36+16);K(n),c(n.length),r&&(K(r),s(r.length));function a(){let g=t.length;if(g!==16&&g!==24&&g!==32)throw new Error(`key length must be 16, 24 or 32 bytes, got: ${g} bytes`);let y=Wt(t),p=new Uint8Array(g),d=new Uint8Array(16),h=j(n),w=0,x=h[0],E=h[1],L=h[2],U=0;for(let B of[d,p].map(j)){let A=j(B);for(let I=0;I<A.length;I+=2){let{s0:k,s1:_}=gt(y,w,x,E,L);A[I+0]=k,A[I+1]=_,w=++U}}return y.fill(0),{authKey:d,encKey:Wt(p)}}function l(g,y,p){let d=Eo(lo,!0,y,p,r);for(let U=0;U<12;U++)d[U]^=n[U];d[15]&=127;let h=j(d),w=h[0],x=h[1],E=h[2],L=h[3];return{s0:w,s1:x,s2:E,s3:L}=gt(g,w,x,E,L),h[0]=w,h[1]=x,h[2]=E,h[3]=L,d}function u(g,y,p){let d=y.slice();return d[15]|=128,Ne(g,!0,d,p)}return{encrypt:g=>{K(g),i(g.length);let{encKey:y,authKey:p}=a(),d=l(y,p,g),h=new Uint8Array(g.length+16);return h.set(d,g.length),h.set(u(y,d,g)),y.fill(0),p.fill(0),h},decrypt:g=>{K(g),f(g.length);let y=g.subarray(-16),{encKey:p,authKey:d}=a(),h=u(p,y,g.subarray(0,-16)),w=l(p,d,h);if(p.fill(0),d.fill(0),!oe(y,w))throw new Error("invalid polyval tag");return h}}});function be(e){if(!Number.isSafeInteger(e))throw new Error(`Wrong integer: ${e}`)}function _t(...e){let t=(o,s)=>i=>o(s(i)),n=Array.from(e).reverse().reduce((o,s)=>o?t(o,s.encode):s.encode,void 0),r=e.reduce((o,s)=>o?t(o,s.decode):s.decode,void 0);return{encode:n,decode:r}}function Ot(e){return{encode:t=>{if(!Array.isArray(t)||t.length&&typeof t[0]!="number")throw new Error("alphabet.encode input should be an array of numbers");return t.map(n=>{if(be(n),n<0||n>=e.length)throw new Error(`Digit index outside alphabet: ${n} (alphabet: ${e.length})`);return e[n]})},decode:t=>{if(!Array.isArray(t)||t.length&&typeof t[0]!="string")throw new Error("alphabet.decode input should be array of strings");return t.map(n=>{if(typeof n!="string")throw new Error(`alphabet.decode: not string element=${n}`);let r=e.indexOf(n);if(r===-1)throw new Error(`Unknown letter: "${n}". Allowed: ${e}`);return r})}}}function Nt(e=""){if(typeof e!="string")throw new Error("join separator should be string");return{encode:t=>{if(!Array.isArray(t)||t.length&&typeof t[0]!="string")throw new Error("join.encode input should be array of strings");for(let n of t)if(typeof n!="string")throw new Error(`join.encode: non-string input=${n}`);return t.join(e)},decode:t=>{if(typeof t!="string")throw new Error("join.decode input should be string");return t.split(e)}}}function ln(e,t="="){if(be(e),typeof t!="string")throw new Error("padding chr should be string");return{encode(n){if(!Array.isArray(n)||n.length&&typeof n[0]!="string")throw new Error("padding.encode input should be array of strings");for(let r of n)if(typeof r!="string")throw new Error(`padding.encode: non-string input=${r}`);for(;n.length*e%8;)n.push(t);return n},decode(n){if(!Array.isArray(n)||n.length&&typeof n[0]!="string")throw new Error("padding.encode input should be array of strings");for(let o of n)if(typeof o!="string")throw new Error(`padding.decode: non-string input=${o}`);let r=n.length;if(r*e%8)throw new Error("Invalid padding: string should have whole number of bytes");for(;r>0&&n[r-1]===t;r--)if(!((r-1)*e%8))throw new Error("Invalid padding: string has too much padding");return n.slice(0,r)}}}function Io(e){if(typeof e!="function")throw new Error("normalize fn should be function");return{encode:t=>t,decode:t=>e(t)}}function Bo(e,t,n){if(t<2)throw new Error(`convertRadix: wrong from=${t}, base cannot be less than 2`);if(n<2)throw new Error(`convertRadix: wrong to=${n}, base cannot be less than 2`);if(!Array.isArray(e))throw new Error("convertRadix: data should be array");if(!e.length)return[];let r=0,o=[],s=Array.from(e);for(s.forEach(i=>{if(be(i),i<0||i>=t)throw new Error(`Wrong integer: ${i}`)});;){let i=0,c=!0;for(let f=r;f<s.length;f++){let a=s[f],l=t*i+a;if(!Number.isSafeInteger(l)||t*i/t!==i||l-a!==t*i)throw new Error("convertRadix: carry overflow");if(i=l%n,s[f]=Math.floor(l/n),!Number.isSafeInteger(s[f])||s[f]*n+i!==l)throw new Error("convertRadix: carry overflow");if(c)s[f]?c=!1:r=f;else continue}if(o.push(i),c)break}for(let i=0;i<e.length-1&&e[i]===0;i++)o.push(0);return o.reverse()}var Uo=(e,t)=>t?Uo(t,e%t):e,un=(e,t)=>e+(t-Uo(e,t));function ir(e,t,n,r){if(!Array.isArray(e))throw new Error("convertRadix2: data should be array");if(t<=0||t>32)throw new Error(`convertRadix2: wrong from=${t}`);if(n<=0||n>32)throw new Error(`convertRadix2: wrong to=${n}`);if(un(t,n)>32)throw new Error(`convertRadix2: carry overflow from=${t} to=${n} carryBits=${un(t,n)}`);let o=0,s=0,i=2**n-1,c=[];for(let f of e){if(be(f),f>=2**t)throw new Error(`convertRadix2: invalid data word=${f} from=${t}`);if(o=o<<t|f,s+t>32)throw new Error(`convertRadix2: carry overflow pos=${s} from=${t}`);for(s+=t;s>=n;s-=n)c.push((o>>s-n&i)>>>0);o&=2**s-1}if(o=o<<n-s&i,!r&&s>=t)throw new Error("Excess padding");if(!r&&o)throw new Error(`Non-zero padding: ${o}`);return r&&s>0&&c.push(o>>>0),c}function Ii(e){return be(e),{encode:t=>{if(!(t instanceof Uint8Array))throw new Error("radix.encode input should be Uint8Array");return Bo(Array.from(t),2**8,e)},decode:t=>{if(!Array.isArray(t)||t.length&&typeof t[0]!="number")throw new Error("radix.decode input should be array of strings");return Uint8Array.from(Bo(t,e,2**8))}}}function Gt(e,t=!1){if(be(e),e<=0||e>32)throw new Error("radix2: bits should be in (0..32]");if(un(8,e)>32||un(e,8)>32)throw new Error("radix2: carry overflow");return{encode:n=>{if(!(n instanceof Uint8Array))throw new Error("radix2.encode input should be Uint8Array");return ir(Array.from(n),8,e,!t)},decode:n=>{if(!Array.isArray(n)||n.length&&typeof n[0]!="number")throw new Error("radix2.decode input should be array of strings");return Uint8Array.from(ir(n,e,8,t))}}}function vo(e){if(typeof e!="function")throw new Error("unsafeWrapper fn should be function");return function(...t){try{return e.apply(null,t)}catch{}}}var Ui=_t(Gt(4),Ot("0123456789ABCDEF"),Nt("")),Ti=_t(Gt(5),Ot("ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"),ln(5),Nt("")),fa=_t(Gt(5),Ot("0123456789ABCDEFGHIJKLMNOPQRSTUV"),ln(5),Nt("")),aa=_t(Gt(5),Ot("0123456789ABCDEFGHJKMNPQRSTVWXYZ"),Nt(""),Io(e=>e.toUpperCase().replace(/O/g,"0").replace(/[IL]/g,"1"))),Ht=_t(Gt(6),Ot("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),ln(6),Nt("")),_i=_t(Gt(6),Ot("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"),ln(6),Nt("")),ar=e=>_t(Ii(58),Ot(e),Nt("")),cr=ar("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"),ua=ar("123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"),la=ar("rpshnaf39wBUDNEGHJKLM4PQRST7VWXYZ2bcdeCg65jkm8oFqi1tuvAxyz"),Ao=[0,2,3,5,6,7,9,10,11],Oi={encode(e){let t="";for(let n=0;n<e.length;n+=8){let r=e.subarray(n,n+8);t+=cr.encode(r).padStart(Ao[r.length],"1")}return t},decode(e){let t=[];for(let n=0;n<e.length;n+=11){let r=e.slice(n,n+11),o=Ao.indexOf(r.length),s=cr.decode(r);for(let i=0;i<s.length-o;i++)if(s[i]!==0)throw new Error("base58xmr: wrong padding");t=t.concat(Array.from(s.slice(s.length-o)))}return Uint8Array.from(t)}};var fr=_t(Ot("qpzry9x8gf2tvdw0s3jn54khce6mua7l"),Nt("")),Lo=[996825010,642813549,513874426,1027748829,705979059];function He(e){let t=e>>25,n=(e&33554431)<<5;for(let r=0;r<Lo.length;r++)(t>>r&1)===1&&(n^=Lo[r]);return n}function So(e,t,n=1){let r=e.length,o=1;for(let s=0;s<r;s++){let i=e.charCodeAt(s);if(i<33||i>126)throw new Error(`Invalid prefix (${e})`);o=He(o)^i>>5}o=He(o);for(let s=0;s<r;s++)o=He(o)^e.charCodeAt(s)&31;for(let s of t)o=He(o)^s;for(let s=0;s<6;s++)o=He(o);return o^=n,fr.encode(ir([o%2**30],30,5,!1))}function To(e){let t=e==="bech32"?1:734539939,n=Gt(5),r=n.decode,o=n.encode,s=vo(r);function i(l,u,g=90){if(typeof l!="string")throw new Error(`bech32.encode prefix should be string, not ${typeof l}`);if(!Array.isArray(u)||u.length&&typeof u[0]!="number")throw new Error(`bech32.encode words should be array of numbers, not ${typeof u}`);let y=l.length+7+u.length;if(g!==!1&&y>g)throw new TypeError(`Length ${y} exceeds limit ${g}`);return l=l.toLowerCase(),`${l}1${fr.encode(u)}${So(l,u,t)}`}function c(l,u=90){if(typeof l!="string")throw new Error(`bech32.decode input should be string, not ${typeof l}`);if(l.length<8||u!==!1&&l.length>u)throw new TypeError(`Wrong string length: ${l.length} (${l}). Expected (8..${u})`);let g=l.toLowerCase();if(l!==g&&l!==l.toUpperCase())throw new Error("String must be lowercase or uppercase");l=g;let y=l.lastIndexOf("1");if(y===0||y===-1)throw new Error('Letter "1" must be present between prefix and data only');let p=l.slice(0,y),d=l.slice(y+1);if(d.length<6)throw new Error("Data must be at least 6 characters long");let h=fr.decode(d).slice(0,-6),w=So(p,h,t);if(!d.endsWith(w))throw new Error(`Invalid checksum in ${l}: expected "${w}"`);return{prefix:p,words:h}}let f=vo(c);function a(l){let{prefix:u,words:g}=c(l,!1);return{prefix:u,words:g,bytes:r(g)}}return{encode:i,decode:c,decodeToBytes:a,decodeUnsafe:f,fromWords:r,fromWordsUnsafe:s,toWords:o}}var ur=To("bech32"),da=To("bech32m"),Ni={encode:e=>new TextDecoder().decode(e),decode:e=>new TextEncoder().encode(e)},Hi=_t(Gt(4),Ot("0123456789abcdef"),Nt(""),Io(e=>{if(typeof e!="string"||e.length%2)throw new TypeError(`hex.decode: expected string, got ${typeof e} with length ${e.length}`);return e.toLowerCase()})),ki={utf8:Ni,hex:Hi,base16:Ui,base32:Ti,base64:Ht,base64url:_i,base58:cr,base58xmr:Oi},ha=`Invalid encoding type. Available types: ${Object.keys(ki).join(", ")}`;var qi=new TextDecoder("utf-8"),Ci=new TextEncoder;async function Ri(e,t,n){let r=e instanceof Uint8Array?Ut(e):e,o=Kt.getSharedSecret(r,"02"+t),s=_o(o),i=Uint8Array.from(tn(16)),c=Ci.encode(n),f=sr(s,i).encrypt(c),a=Ht.encode(new Uint8Array(f)),l=Ht.encode(new Uint8Array(i.buffer));return`${a}?iv=${l}`}async function $i(e,t,n){let r=e instanceof Uint8Array?Ut(e):e,[o,s]=n.split("?iv="),i=Kt.getSharedSecret(r,"02"+t),c=_o(i),f=Ht.decode(s),a=Ht.decode(o),l=sr(c,f).decrypt(a);return qi.decode(l)}function _o(e){return e.slice(1,33)}var Ea=new TextDecoder("utf-8"),Ba=new TextEncoder,Vi=5e3;function Ki(e){return Pi("npub",io(e))}function ji(e,t){let n=ur.toWords(t);return ur.encode(e,n,Vi)}function Pi(e,t){return ji(e,t)}var nt=(e,t)=>e[t++]&255|(e[t++]&255)<<8,lr=class{constructor(t){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,t=Bt(t),K(t,32);let n=nt(t,0),r=nt(t,2),o=nt(t,4),s=nt(t,6),i=nt(t,8),c=nt(t,10),f=nt(t,12),a=nt(t,14);this.r[0]=n&8191,this.r[1]=(n>>>13|r<<3)&8191,this.r[2]=(r>>>10|o<<6)&7939,this.r[3]=(o>>>7|s<<9)&8191,this.r[4]=(s>>>4|i<<12)&255,this.r[5]=i>>>1&8190,this.r[6]=(i>>>14|c<<2)&8191,this.r[7]=(c>>>11|f<<5)&8065,this.r[8]=(f>>>8|a<<8)&8191,this.r[9]=a>>>5&127;for(let l=0;l<8;l++)this.pad[l]=nt(t,16+2*l)}process(t,n,r=!1){let o=r?0:2048,{h:s,r:i}=this,c=i[0],f=i[1],a=i[2],l=i[3],u=i[4],g=i[5],y=i[6],p=i[7],d=i[8],h=i[9],w=nt(t,n+0),x=nt(t,n+2),E=nt(t,n+4),L=nt(t,n+6),U=nt(t,n+8),B=nt(t,n+10),A=nt(t,n+12),I=nt(t,n+14),k=s[0]+(w&8191),_=s[1]+((w>>>13|x<<3)&8191),T=s[2]+((x>>>10|E<<6)&8191),q=s[3]+((E>>>7|L<<9)&8191),C=s[4]+((L>>>4|U<<12)&8191),V=s[5]+(U>>>1&8191),b=s[6]+((U>>>14|B<<2)&8191),m=s[7]+((B>>>11|A<<5)&8191),S=s[8]+((A>>>8|I<<8)&8191),O=s[9]+(I>>>5|o),v=0,H=v+k*c+_*(5*h)+T*(5*d)+q*(5*p)+C*(5*y);v=H>>>13,H&=8191,H+=V*(5*g)+b*(5*u)+m*(5*l)+S*(5*a)+O*(5*f),v+=H>>>13,H&=8191;let $=v+k*f+_*c+T*(5*h)+q*(5*d)+C*(5*p);v=$>>>13,$&=8191,$+=V*(5*y)+b*(5*g)+m*(5*u)+S*(5*l)+O*(5*a),v+=$>>>13,$&=8191;let R=v+k*a+_*f+T*c+q*(5*h)+C*(5*d);v=R>>>13,R&=8191,R+=V*(5*p)+b*(5*y)+m*(5*g)+S*(5*u)+O*(5*l),v+=R>>>13,R&=8191;let P=v+k*l+_*a+T*f+q*c+C*(5*h);v=P>>>13,P&=8191,P+=V*(5*d)+b*(5*p)+m*(5*y)+S*(5*g)+O*(5*u),v+=P>>>13,P&=8191;let z=v+k*u+_*l+T*a+q*f+C*c;v=z>>>13,z&=8191,z+=V*(5*h)+b*(5*d)+m*(5*p)+S*(5*y)+O*(5*g),v+=z>>>13,z&=8191;let Y=v+k*g+_*u+T*l+q*a+C*f;v=Y>>>13,Y&=8191,Y+=V*c+b*(5*h)+m*(5*d)+S*(5*p)+O*(5*y),v+=Y>>>13,Y&=8191;let tt=v+k*y+_*g+T*u+q*l+C*a;v=tt>>>13,tt&=8191,tt+=V*f+b*c+m*(5*h)+S*(5*d)+O*(5*p),v+=tt>>>13,tt&=8191;let Z=v+k*p+_*y+T*g+q*u+C*l;v=Z>>>13,Z&=8191,Z+=V*a+b*f+m*c+S*(5*h)+O*(5*d),v+=Z>>>13,Z&=8191;let st=v+k*d+_*p+T*y+q*g+C*u;v=st>>>13,st&=8191,st+=V*l+b*a+m*f+S*c+O*(5*h),v+=st>>>13,st&=8191;let D=v+k*h+_*d+T*p+q*y+C*g;v=D>>>13,D&=8191,D+=V*u+b*l+m*a+S*f+O*c,v+=D>>>13,D&=8191,v=(v<<2)+v|0,v=v+H|0,H=v&8191,v=v>>>13,$+=v,s[0]=H,s[1]=$,s[2]=R,s[3]=P,s[4]=z,s[5]=Y,s[6]=tt,s[7]=Z,s[8]=st,s[9]=D}finalize(){let{h:t,pad:n}=this,r=new Uint16Array(10),o=t[1]>>>13;t[1]&=8191;for(let c=2;c<10;c++)t[c]+=o,o=t[c]>>>13,t[c]&=8191;t[0]+=o*5,o=t[0]>>>13,t[0]&=8191,t[1]+=o,o=t[1]>>>13,t[1]&=8191,t[2]+=o,r[0]=t[0]+5,o=r[0]>>>13,r[0]&=8191;for(let c=1;c<10;c++)r[c]=t[c]+o,o=r[c]>>>13,r[c]&=8191;r[9]-=8192;let s=(o^1)-1;for(let c=0;c<10;c++)r[c]&=s;s=~s;for(let c=0;c<10;c++)t[c]=t[c]&s|r[c];t[0]=(t[0]|t[1]<<13)&65535,t[1]=(t[1]>>>3|t[2]<<10)&65535,t[2]=(t[2]>>>6|t[3]<<7)&65535,t[3]=(t[3]>>>9|t[4]<<4)&65535,t[4]=(t[4]>>>12|t[5]<<1|t[6]<<14)&65535,t[5]=(t[6]>>>2|t[7]<<11)&65535,t[6]=(t[7]>>>5|t[8]<<8)&65535,t[7]=(t[8]>>>8|t[9]<<5)&65535;let i=t[0]+n[0];t[0]=i&65535;for(let c=1;c<8;c++)i=(t[c]+n[c]|0)+(i>>>16)|0,t[c]=i&65535}update(t){Zt(this);let{buffer:n,blockLen:r}=this;t=Bt(t);let o=t.length;for(let s=0;s<o;){let i=Math.min(r-this.pos,o-s);if(i===r){for(;r<=o-s;s+=r)this.process(t,s);continue}n.set(t.subarray(s,s+i),this.pos),this.pos+=i,s+=i,this.pos===r&&(this.process(n,0,!1),this.pos=0)}return this}destroy(){this.h.fill(0),this.r.fill(0),this.buffer.fill(0),this.pad.fill(0)}digestInto(t){Zt(this),Oe(t,this),this.finished=!0;let{buffer:n,h:r}=this,{pos:o}=this;if(o){for(n[o++]=1;o<16;o++)n[o]=0;this.process(n,0,!0)}this.finalize();let s=0;for(let i=0;i<8;i++)t[s++]=r[i]>>>0,t[s++]=r[i]>>>8;return t}digest(){let{buffer:t,outputLen:n}=this;this.digestInto(t);let r=t.slice(0,n);return this.destroy(),r}};function zi(e){let t=(r,o)=>e(o).update(Bt(r)).digest(),n=e(new Uint8Array(32));return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=r=>e(r),t}var No=zi(e=>new lr(e));var ko=e=>Uint8Array.from(e.split("").map(t=>t.charCodeAt(0))),Zi=ko("expand 16-byte k"),Mi=ko("expand 32-byte k"),Di=j(Zi),qo=j(Mi),Ta=qo.slice();function N(e,t){return e<<t|e>>>32-t}function dr(e){return e.byteOffset%4===0}var dn=64,Wi=16,Co=2**32-1,Ho=new Uint32Array;function Gi(e,t,n,r,o,s,i,c){let f=o.length,a=new Uint8Array(dn),l=j(a),u=dr(o)&&dr(s),g=u?j(o):Ho,y=u?j(s):Ho;for(let p=0;p<f;i++){if(e(t,n,r,l,i,c),i>=Co)throw new Error("arx: counter overflow");let d=Math.min(dn,f-p);if(u&&d===dn){let h=p/4;if(p%4!==0)throw new Error("arx: invalid block position");for(let w=0,x;w<Wi;w++)x=h+w,y[x]=g[x]^l[w];p+=dn;continue}for(let h=0,w;h<d;h++)w=p+h,s[w]=o[w]^a[h];p+=d}}function hr(e,t){let{allowShortKeys:n,extendNonceFn:r,counterLength:o,counterRight:s,rounds:i}=ao({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},t);if(typeof e!="function")throw new Error("core must be a function");return on(o),on(i),Yn(s),Yn(n),(c,f,a,l,u=0)=>{K(c),K(f),K(a);let g=a.length;if(l||(l=new Uint8Array(g)),K(l),on(u),u<0||u>=Co)throw new Error("arx: counter overflow");if(l.length<g)throw new Error(`arx: output (${l.length}) is shorter than data (${g})`);let y=[],p=c.length,d,h;if(p===32)d=c.slice(),y.push(d),h=qo;else if(p===16&&n)d=new Uint8Array(32),d.set(c),d.set(c,16),h=Di,y.push(d);else throw new Error(`arx: invalid 32-byte key, got length=${p}`);dr(f)||(f=f.slice(),y.push(f));let w=j(d);if(r){if(f.length!==24)throw new Error("arx: extended nonce must be 24 bytes");r(h,w,j(f.subarray(0,16)),w),f=f.subarray(16)}let x=16-o;if(x!==f.length)throw new Error(`arx: nonce must be ${x} or 16 bytes`);if(x!==12){let L=new Uint8Array(12);L.set(f,s?0:12-f.length),f=L,y.push(f)}let E=j(f);for(Gi(e,h,w,E,a,l,u,i);y.length>0;)y.pop().fill(0);return l}}function Vo(e,t,n,r,o,s=20){let i=e[0],c=e[1],f=e[2],a=e[3],l=t[0],u=t[1],g=t[2],y=t[3],p=t[4],d=t[5],h=t[6],w=t[7],x=o,E=n[0],L=n[1],U=n[2],B=i,A=c,I=f,k=a,_=l,T=u,q=g,C=y,V=p,b=d,m=h,S=w,O=x,v=E,H=L,$=U;for(let P=0;P<s;P+=2)B=B+_|0,O=N(O^B,16),V=V+O|0,_=N(_^V,12),B=B+_|0,O=N(O^B,8),V=V+O|0,_=N(_^V,7),A=A+T|0,v=N(v^A,16),b=b+v|0,T=N(T^b,12),A=A+T|0,v=N(v^A,8),b=b+v|0,T=N(T^b,7),I=I+q|0,H=N(H^I,16),m=m+H|0,q=N(q^m,12),I=I+q|0,H=N(H^I,8),m=m+H|0,q=N(q^m,7),k=k+C|0,$=N($^k,16),S=S+$|0,C=N(C^S,12),k=k+C|0,$=N($^k,8),S=S+$|0,C=N(C^S,7),B=B+T|0,$=N($^B,16),m=m+$|0,T=N(T^m,12),B=B+T|0,$=N($^B,8),m=m+$|0,T=N(T^m,7),A=A+q|0,O=N(O^A,16),S=S+O|0,q=N(q^S,12),A=A+q|0,O=N(O^A,8),S=S+O|0,q=N(q^S,7),I=I+C|0,v=N(v^I,16),V=V+v|0,C=N(C^V,12),I=I+C|0,v=N(v^I,8),V=V+v|0,C=N(C^V,7),k=k+_|0,H=N(H^k,16),b=b+H|0,_=N(_^b,12),k=k+_|0,H=N(H^k,8),b=b+H|0,_=N(_^b,7);let R=0;r[R++]=i+B|0,r[R++]=c+A|0,r[R++]=f+I|0,r[R++]=a+k|0,r[R++]=l+_|0,r[R++]=u+T|0,r[R++]=g+q|0,r[R++]=y+C|0,r[R++]=p+V|0,r[R++]=d+b|0,r[R++]=h+m|0,r[R++]=w+S|0,r[R++]=x+O|0,r[R++]=E+v|0,r[R++]=L+H|0,r[R++]=U+$|0}function Yi(e,t,n,r){let o=e[0],s=e[1],i=e[2],c=e[3],f=t[0],a=t[1],l=t[2],u=t[3],g=t[4],y=t[5],p=t[6],d=t[7],h=n[0],w=n[1],x=n[2],E=n[3];for(let U=0;U<20;U+=2)o=o+f|0,h=N(h^o,16),g=g+h|0,f=N(f^g,12),o=o+f|0,h=N(h^o,8),g=g+h|0,f=N(f^g,7),s=s+a|0,w=N(w^s,16),y=y+w|0,a=N(a^y,12),s=s+a|0,w=N(w^s,8),y=y+w|0,a=N(a^y,7),i=i+l|0,x=N(x^i,16),p=p+x|0,l=N(l^p,12),i=i+l|0,x=N(x^i,8),p=p+x|0,l=N(l^p,7),c=c+u|0,E=N(E^c,16),d=d+E|0,u=N(u^d,12),c=c+u|0,E=N(E^c,8),d=d+E|0,u=N(u^d,7),o=o+a|0,E=N(E^o,16),p=p+E|0,a=N(a^p,12),o=o+a|0,E=N(E^o,8),p=p+E|0,a=N(a^p,7),s=s+l|0,h=N(h^s,16),d=d+h|0,l=N(l^d,12),s=s+l|0,h=N(h^s,8),d=d+h|0,l=N(l^d,7),i=i+u|0,w=N(w^i,16),g=g+w|0,u=N(u^g,12),i=i+u|0,w=N(w^i,8),g=g+w|0,u=N(u^g,7),c=c+f|0,x=N(x^c,16),y=y+x|0,f=N(f^y,12),c=c+f|0,x=N(x^c,8),y=y+x|0,f=N(f^y,7);let L=0;r[L++]=o,r[L++]=s,r[L++]=i,r[L++]=c,r[L++]=h,r[L++]=w,r[L++]=x,r[L++]=E}var hn=hr(Vo,{counterRight:!1,counterLength:4,allowShortKeys:!1}),Xi=hr(Vo,{counterRight:!1,counterLength:8,extendNonceFn:Yi,allowShortKeys:!1});var Qi=new Uint8Array(16),Ro=(e,t)=>{e.update(t);let n=t.length%16;n&&e.update(Qi.subarray(n))},Ji=new Uint8Array(32);function $o(e,t,n,r,o){let s=e(t,n,Ji),i=No.create(s);o&&Ro(i,o),Ro(i,r);let c=new Uint8Array(16),f=Mt(c);se(f,0,BigInt(o?o.length:0),!0),se(f,8,BigInt(r.length),!0),i.update(c);let a=i.digest();return s.fill(0),a}var Ko=e=>(t,n,r)=>(K(t,32),K(n),{encrypt:(s,i)=>{let c=s.length,f=c+16;i?K(i,f):i=new Uint8Array(f),e(t,n,s,i,1);let a=$o(e,t,n,i.subarray(0,-16),r);return i.set(a,c),i},decrypt:(s,i)=>{let c=s.length,f=c-16;if(c<16)throw new Error("encrypted data must be at least 16 bytes");i?K(i,f):i=new Uint8Array(f);let a=s.subarray(0,-16),l=s.subarray(-16),u=$o(e,t,n,a,r);if(!oe(l,u))throw new Error("invalid tag");return e(t,n,a,i,1),i}}),qa=vt({blockSize:64,nonceLength:12,tagLength:16},Ko(hn)),Ca=vt({blockSize:64,nonceLength:24,tagLength:16},Ko(Xi));var pn=class extends he{constructor(t,n){super(),this.finished=!1,this.destroyed=!1,ut.hash(t);let r=jt(n);if(this.iHash=t.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let o=this.blockLen,s=new Uint8Array(o);s.set(r.length>o?t.create().update(r).digest():r);for(let i=0;i<s.length;i++)s[i]^=54;this.iHash.update(s),this.oHash=t.create();for(let i=0;i<s.length;i++)s[i]^=106;this.oHash.update(s),s.fill(0)}update(t){return ut.exists(this),this.iHash.update(t),this}digestInto(t){ut.exists(this),ut.bytes(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){let t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));let{oHash:n,iHash:r,finished:o,destroyed:s,blockLen:i,outputLen:c}=this;return t=t,t.finished=o,t.destroyed=s,t.blockLen=i,t.outputLen=c,t.oHash=n._cloneInto(t.oHash),t.iHash=r._cloneInto(t.iHash),t}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}},xe=(e,t,n)=>new pn(e,t).update(n).digest();xe.create=(e,t)=>new pn(e,t);function Po(e,t,n){return ut.hash(e),n===void 0&&(n=new Uint8Array(e.outputLen)),xe(e,jt(n),jt(t))}var pr=new Uint8Array([0]),jo=new Uint8Array;function zo(e,t,n,r=32){if(ut.hash(e),ut.number(r),r>255*e.outputLen)throw new Error("Length should be <= 255*HashLen");let o=Math.ceil(r/e.outputLen);n===void 0&&(n=jo);let s=new Uint8Array(o*e.outputLen),i=xe.create(e,t),c=i._cloneInto(),f=new Uint8Array(i.outputLen);for(let a=0;a<o;a++)pr[0]=a+1,c.update(a===0?jo:f).update(n).update(pr).digestInto(f),s.set(f,e.outputLen*a),i._cloneInto(c);return i.destroy(),c.destroy(),f.fill(0),pr.fill(0),s.slice(0,r)}var Fi=new TextDecoder("utf-8"),tc=new TextEncoder,Zo=1,Mo=65535;function ec(e,t){let n=Kt.getSharedSecret(e,"02"+t).subarray(1,33);return Po(pe,n,"nip44-v2")}function Do(e,t){let n=zo(pe,e,t,76);return{chacha_key:n.subarray(0,32),chacha_nonce:n.subarray(32,44),hmac_key:n.subarray(44,76)}}function gr(e){if(!Number.isSafeInteger(e)||e<1)throw new Error("expected positive integer");if(e<=32)return 32;let t=1<<Math.floor(Math.log2(e-1))+1,n=t<=256?32:t/8;return n*(Math.floor((e-1)/n)+1)}function nc(e){if(!Number.isSafeInteger(e)||e<Zo||e>Mo)throw new Error("invalid plaintext size: must be between 1 and 65535 bytes");let t=new Uint8Array(2);return new DataView(t.buffer).setUint16(0,e,!1),t}function rc(e){let t=tc.encode(e),n=t.length,r=nc(n),o=new Uint8Array(gr(n)-n);return _e(r,t,o)}function oc(e){let t=new DataView(e.buffer).getUint16(0),n=e.subarray(2,2+t);if(t<Zo||t>Mo||n.length!==t||e.length!==2+gr(t))throw new Error("invalid padding");return Fi.decode(n)}function Wo(e,t,n){if(n.length!==32)throw new Error("AAD associated data must be 32 bytes");let r=_e(n,t);return xe(pe,e,r)}function sc(e){if(typeof e!="string")throw new Error("payload must be a valid string");let t=e.length;if(t<132||t>87472)throw new Error("invalid payload length: "+t);if(e[0]==="#")throw new Error("unknown encryption version");let n;try{n=Ht.decode(e)}catch(s){throw new Error("invalid base64: "+s.message)}let r=n.length;if(r<99||r>65603)throw new Error("invalid data length: "+r);let o=n[0];if(o!==2)throw new Error("unknown encryption version "+o);return{nonce:n.subarray(1,33),ciphertext:n.subarray(33,-32),mac:n.subarray(-32)}}function ic(e,t,n=tn(32)){let{chacha_key:r,chacha_nonce:o,hmac_key:s}=Do(t,n),i=rc(e),c=hn(r,o,i),f=Wo(s,c,n);return Ht.encode(_e(new Uint8Array([2]),n,c,f))}function cc(e,t){let{nonce:n,ciphertext:r,mac:o}=sc(e),{chacha_key:s,chacha_nonce:i,hmac_key:c}=Do(t,n),f=Wo(c,r,n);if(!oe(f,o))throw new Error("invalid MAC");let a=hn(s,i,r);return oc(a)}var wr={utils:{getConversationKey:ec,calcPaddedLen:gr},encrypt:ic,decrypt:cc};function yr(e){if(!Number.isSafeInteger(e)||e<0)throw new Error(`Wrong positive integer: ${e}`)}function fc(e){return e instanceof Uint8Array||e!=null&&typeof e=="object"&&e.constructor.name==="Uint8Array"}function br(e,...t){if(!fc(e))throw new Error("Expected Uint8Array");if(t.length>0&&!t.includes(e.length))throw new Error(`Expected Uint8Array of length ${t}, not of length=${e.length}`)}function gn(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");yr(e.outputLen),yr(e.blockLen)}function me(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function Go(e,t){br(e);let n=t.outputLen;if(e.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}var wn=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;function Yo(e){return e instanceof Uint8Array||e!=null&&typeof e=="object"&&e.constructor.name==="Uint8Array"}var yn=e=>new DataView(e.buffer,e.byteOffset,e.byteLength),mt=(e,t)=>e<<32-t|e>>>t,ac=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!ac)throw new Error("Non little-endian hardware is not supported");function uc(e){if(typeof e!="string")throw new Error(`utf8ToBytes expected string, got ${typeof e}`);return new Uint8Array(new TextEncoder().encode(e))}function Yt(e){if(typeof e=="string"&&(e=uc(e)),!Yo(e))throw new Error(`expected Uint8Array, got ${typeof e}`);return e}function Xo(...e){let t=0;for(let r=0;r<e.length;r++){let o=e[r];if(!Yo(o))throw new Error("Uint8Array expected");t+=o.length}let n=new Uint8Array(t);for(let r=0,o=0;r<e.length;r++){let s=e[r];n.set(s,o),o+=s.length}return n}var Ee=class{clone(){return this._cloneInto()}},ru={}.toString;function Qo(e){let t=r=>e().update(Yt(r)).digest(),n=e();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=()=>e(),t}function Jo(e=32){if(wn&&typeof wn.getRandomValues=="function")return wn.getRandomValues(new Uint8Array(e));throw new Error("crypto.getRandomValues must be defined")}function lc(e,t,n,r){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,n,r);let o=BigInt(32),s=BigInt(4294967295),i=Number(n>>o&s),c=Number(n&s),f=r?4:0,a=r?0:4;e.setUint32(t+f,i,r),e.setUint32(t+a,c,r)}var bn=class extends Ee{constructor(t,n,r,o){super(),this.blockLen=t,this.outputLen=n,this.padOffset=r,this.isLE=o,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=yn(this.buffer)}update(t){me(this);let{view:n,buffer:r,blockLen:o}=this;t=Yt(t);let s=t.length;for(let i=0;i<s;){let c=Math.min(o-this.pos,s-i);if(c===o){let f=yn(t);for(;o<=s-i;i+=o)this.process(f,i);continue}r.set(t.subarray(i,i+c),this.pos),this.pos+=c,i+=c,this.pos===o&&(this.process(n,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){me(this),Go(t,this),this.finished=!0;let{buffer:n,view:r,blockLen:o,isLE:s}=this,{pos:i}=this;n[i++]=128,this.buffer.subarray(i).fill(0),this.padOffset>o-i&&(this.process(r,0),i=0);for(let u=i;u<o;u++)n[u]=0;lc(r,o-8,BigInt(this.length*8),s),this.process(r,0);let c=yn(t),f=this.outputLen;if(f%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let a=f/4,l=this.get();if(a>l.length)throw new Error("_sha2: outputLen bigger than state");for(let u=0;u<a;u++)c.setUint32(4*u,l[u],s)}digest(){let{buffer:t,outputLen:n}=this;this.digestInto(t);let r=t.slice(0,n);return this.destroy(),r}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());let{blockLen:n,buffer:r,length:o,finished:s,destroyed:i,pos:c}=this;return t.length=o,t.pos=c,t.finished=s,t.destroyed=i,o%n&&t.buffer.set(r),t}};var dc=(e,t,n)=>e&t^~e&n,hc=(e,t,n)=>e&t^e&n^t&n,pc=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Xt=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Qt=new Uint32Array(64),xr=class extends bn{constructor(){super(64,32,8,!1),this.A=Xt[0]|0,this.B=Xt[1]|0,this.C=Xt[2]|0,this.D=Xt[3]|0,this.E=Xt[4]|0,this.F=Xt[5]|0,this.G=Xt[6]|0,this.H=Xt[7]|0}get(){let{A:t,B:n,C:r,D:o,E:s,F:i,G:c,H:f}=this;return[t,n,r,o,s,i,c,f]}set(t,n,r,o,s,i,c,f){this.A=t|0,this.B=n|0,this.C=r|0,this.D=o|0,this.E=s|0,this.F=i|0,this.G=c|0,this.H=f|0}process(t,n){for(let u=0;u<16;u++,n+=4)Qt[u]=t.getUint32(n,!1);for(let u=16;u<64;u++){let g=Qt[u-15],y=Qt[u-2],p=mt(g,7)^mt(g,18)^g>>>3,d=mt(y,17)^mt(y,19)^y>>>10;Qt[u]=d+Qt[u-7]+p+Qt[u-16]|0}let{A:r,B:o,C:s,D:i,E:c,F:f,G:a,H:l}=this;for(let u=0;u<64;u++){let g=mt(c,6)^mt(c,11)^mt(c,25),y=l+g+dc(c,f,a)+pc[u]+Qt[u]|0,d=(mt(r,2)^mt(r,13)^mt(r,22))+hc(r,o,s)|0;l=a,a=f,f=c,c=i+y|0,i=s,s=o,o=r,r=y+d|0}r=r+this.A|0,o=o+this.B|0,s=s+this.C|0,i=i+this.D|0,c=c+this.E|0,f=f+this.F|0,a=a+this.G|0,l=l+this.H|0,this.set(r,o,s,i,c,f,a,l)}roundClean(){Qt.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};var Be=Qo(()=>new xr);var vr={};An(vr,{bitGet:()=>Ec,bitLen:()=>mc,bitMask:()=>ke,bitSet:()=>Bc,bytesToHex:()=>ie,bytesToNumberBE:()=>qt,bytesToNumberLE:()=>mn,concatBytes:()=>ve,createHmacDrbg:()=>Br,ensureBytes:()=>lt,equalBytes:()=>bc,hexToBytes:()=>ce,hexToNumber:()=>Er,isBytes:()=>Et,numberToBytesBE:()=>Jt,numberToBytesLE:()=>En,numberToHexUnpadded:()=>ns,numberToVarBytesBE:()=>yc,utf8ToBytes:()=>xc,validateObject:()=>Ft});var es=BigInt(0),xn=BigInt(1),gc=BigInt(2);function Et(e){return e instanceof Uint8Array||e!=null&&typeof e=="object"&&e.constructor.name==="Uint8Array"}var wc=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function ie(e){if(!Et(e))throw new Error("Uint8Array expected");let t="";for(let n=0;n<e.length;n++)t+=wc[e[n]];return t}function ns(e){let t=e.toString(16);return t.length&1?`0${t}`:t}function Er(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);return BigInt(e===""?"0":`0x${e}`)}var kt={_0:48,_9:57,_A:65,_F:70,_a:97,_f:102};function Fo(e){if(e>=kt._0&&e<=kt._9)return e-kt._0;if(e>=kt._A&&e<=kt._F)return e-(kt._A-10);if(e>=kt._a&&e<=kt._f)return e-(kt._a-10)}function ce(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);let t=e.length,n=t/2;if(t%2)throw new Error("padded hex string expected, got unpadded hex of length "+t);let r=new Uint8Array(n);for(let o=0,s=0;o<n;o++,s+=2){let i=Fo(e.charCodeAt(s)),c=Fo(e.charCodeAt(s+1));if(i===void 0||c===void 0){let f=e[s]+e[s+1];throw new Error('hex string expected, got non-hex character "'+f+'" at index '+s)}r[o]=i*16+c}return r}function qt(e){return Er(ie(e))}function mn(e){if(!Et(e))throw new Error("Uint8Array expected");return Er(ie(Uint8Array.from(e).reverse()))}function Jt(e,t){return ce(e.toString(16).padStart(t*2,"0"))}function En(e,t){return Jt(e,t).reverse()}function yc(e){return ce(ns(e))}function lt(e,t,n){let r;if(typeof t=="string")try{r=ce(t)}catch(s){throw new Error(`${e} must be valid hex string, got "${t}". Cause: ${s}`)}else if(Et(t))r=Uint8Array.from(t);else throw new Error(`${e} must be hex string or Uint8Array`);let o=r.length;if(typeof n=="number"&&o!==n)throw new Error(`${e} expected ${n} bytes, got ${o}`);return r}function ve(...e){let t=0;for(let o=0;o<e.length;o++){let s=e[o];if(!Et(s))throw new Error("Uint8Array expected");t+=s.length}let n=new Uint8Array(t),r=0;for(let o=0;o<e.length;o++){let s=e[o];n.set(s,r),r+=s.length}return n}function bc(e,t){if(e.length!==t.length)return!1;let n=0;for(let r=0;r<e.length;r++)n|=e[r]^t[r];return n===0}function xc(e){if(typeof e!="string")throw new Error(`utf8ToBytes expected string, got ${typeof e}`);return new Uint8Array(new TextEncoder().encode(e))}function mc(e){let t;for(t=0;e>es;e>>=xn,t+=1);return t}function Ec(e,t){return e>>BigInt(t)&xn}var Bc=(e,t,n)=>e|(n?xn:es)<<BigInt(t),ke=e=>(gc<<BigInt(e-1))-xn,mr=e=>new Uint8Array(e),ts=e=>Uint8Array.from(e);function Br(e,t,n){if(typeof e!="number"||e<2)throw new Error("hashLen must be a number");if(typeof t!="number"||t<2)throw new Error("qByteLen must be a number");if(typeof n!="function")throw new Error("hmacFn must be a function");let r=mr(e),o=mr(e),s=0,i=()=>{r.fill(1),o.fill(0),s=0},c=(...u)=>n(o,r,...u),f=(u=mr())=>{o=c(ts([0]),u),r=c(),u.length!==0&&(o=c(ts([1]),u),r=c())},a=()=>{if(s++>=1e3)throw new Error("drbg: tried 1000 values");let u=0,g=[];for(;u<t;){r=c();let y=r.slice();g.push(y),u+=r.length}return ve(...g)};return(u,g)=>{i(),f(u);let y;for(;!(y=g(a()));)f();return i(),y}}var vc={bigint:e=>typeof e=="bigint",function:e=>typeof e=="function",boolean:e=>typeof e=="boolean",string:e=>typeof e=="string",stringOrUint8Array:e=>typeof e=="string"||Et(e),isSafeInteger:e=>Number.isSafeInteger(e),array:e=>Array.isArray(e),field:(e,t)=>t.Fp.isValid(e),hash:e=>typeof e=="function"&&Number.isSafeInteger(e.outputLen)};function Ft(e,t,n={}){let r=(o,s,i)=>{let c=vc[s];if(typeof c!="function")throw new Error(`Invalid validator "${s}", expected function`);let f=e[o];if(!(i&&f===void 0)&&!c(f,e))throw new Error(`Invalid param ${String(o)}=${f} (${typeof f}), expected ${s}`)};for(let[o,s]of Object.entries(t))r(o,s,!1);for(let[o,s]of Object.entries(n))r(o,s,!0);return e}var F=BigInt(0),G=BigInt(1),fe=BigInt(2),Ac=BigInt(3),Ar=BigInt(4),rs=BigInt(5),os=BigInt(8),Lc=BigInt(9),Sc=BigInt(16);function rt(e,t){let n=e%t;return n>=F?n:t+n}function Ic(e,t,n){if(n<=F||t<F)throw new Error("Expected power/modulo > 0");if(n===G)return F;let r=G;for(;t>F;)t&G&&(r=r*e%n),e=e*e%n,t>>=G;return r}function dt(e,t,n){let r=e;for(;t-- >F;)r*=r,r%=n;return r}function Bn(e,t){if(e===F||t<=F)throw new Error(`invert: expected positive integers, got n=${e} mod=${t}`);let n=rt(e,t),r=t,o=F,s=G,i=G,c=F;for(;n!==F;){let a=r/n,l=r%n,u=o-i*a,g=s-c*a;r=n,n=l,o=i,s=c,i=u,c=g}if(r!==G)throw new Error("invert: does not exist");return rt(o,t)}function Uc(e){let t=(e-G)/fe,n,r,o;for(n=e-G,r=0;n%fe===F;n/=fe,r++);for(o=fe;o<e&&Ic(o,t,e)!==e-G;o++);if(r===1){let i=(e+G)/Ar;return function(f,a){let l=f.pow(a,i);if(!f.eql(f.sqr(l),a))throw new Error("Cannot find square root");return l}}let s=(n+G)/fe;return function(c,f){if(c.pow(f,t)===c.neg(c.ONE))throw new Error("Cannot find square root");let a=r,l=c.pow(c.mul(c.ONE,o),n),u=c.pow(f,s),g=c.pow(f,n);for(;!c.eql(g,c.ONE);){if(c.eql(g,c.ZERO))return c.ZERO;let y=1;for(let d=c.sqr(g);y<a&&!c.eql(d,c.ONE);y++)d=c.sqr(d);let p=c.pow(l,G<<BigInt(a-y-1));l=c.sqr(p),u=c.mul(u,p),g=c.mul(g,l),a=y}return u}}function Tc(e){if(e%Ar===Ac){let t=(e+G)/Ar;return function(r,o){let s=r.pow(o,t);if(!r.eql(r.sqr(s),o))throw new Error("Cannot find square root");return s}}if(e%os===rs){let t=(e-rs)/os;return function(r,o){let s=r.mul(o,fe),i=r.pow(s,t),c=r.mul(o,i),f=r.mul(r.mul(c,fe),i),a=r.mul(c,r.sub(f,r.ONE));if(!r.eql(r.sqr(a),o))throw new Error("Cannot find square root");return a}}return e%Sc,Uc(e)}var _c=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function Lr(e){let t={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},n=_c.reduce((r,o)=>(r[o]="function",r),t);return Ft(e,n)}function Oc(e,t,n){if(n<F)throw new Error("Expected power > 0");if(n===F)return e.ONE;if(n===G)return t;let r=e.ONE,o=t;for(;n>F;)n&G&&(r=e.mul(r,o)),o=e.sqr(o),n>>=G;return r}function Nc(e,t){let n=new Array(t.length),r=t.reduce((s,i,c)=>e.is0(i)?s:(n[c]=s,e.mul(s,i)),e.ONE),o=e.inv(r);return t.reduceRight((s,i,c)=>e.is0(i)?s:(n[c]=e.mul(s,n[c]),e.mul(s,i)),o),n}function Sr(e,t){let n=t!==void 0?t:e.toString(2).length,r=Math.ceil(n/8);return{nBitLength:n,nByteLength:r}}function ss(e,t,n=!1,r={}){if(e<=F)throw new Error(`Expected Field ORDER > 0, got ${e}`);let{nBitLength:o,nByteLength:s}=Sr(e,t);if(s>2048)throw new Error("Field lengths over 2048 bytes are not supported");let i=Tc(e),c=Object.freeze({ORDER:e,BITS:o,BYTES:s,MASK:ke(o),ZERO:F,ONE:G,create:f=>rt(f,e),isValid:f=>{if(typeof f!="bigint")throw new Error(`Invalid field element: expected bigint, got ${typeof f}`);return F<=f&&f<e},is0:f=>f===F,isOdd:f=>(f&G)===G,neg:f=>rt(-f,e),eql:(f,a)=>f===a,sqr:f=>rt(f*f,e),add:(f,a)=>rt(f+a,e),sub:(f,a)=>rt(f-a,e),mul:(f,a)=>rt(f*a,e),pow:(f,a)=>Oc(c,f,a),div:(f,a)=>rt(f*Bn(a,e),e),sqrN:f=>f*f,addN:(f,a)=>f+a,subN:(f,a)=>f-a,mulN:(f,a)=>f*a,inv:f=>Bn(f,e),sqrt:r.sqrt||(f=>i(c,f)),invertBatch:f=>Nc(c,f),cmov:(f,a,l)=>l?a:f,toBytes:f=>n?En(f,s):Jt(f,s),fromBytes:f=>{if(f.length!==s)throw new Error(`Fp.fromBytes: expected ${s}, got ${f.length}`);return n?mn(f):qt(f)}});return Object.freeze(c)}function is(e){if(typeof e!="bigint")throw new Error("field order must be bigint");let t=e.toString(2).length;return Math.ceil(t/8)}function Ir(e){let t=is(e);return t+Math.ceil(t/2)}function cs(e,t,n=!1){let r=e.length,o=is(t),s=Ir(t);if(r<16||r<s||r>1024)throw new Error(`expected ${s}-1024 bytes of input, got ${r}`);let i=n?qt(e):mn(e),c=rt(i,t-G)+G;return n?En(c,o):Jt(c,o)}var kc=BigInt(0),Ur=BigInt(1);function fs(e,t){let n=(o,s)=>{let i=s.negate();return o?i:s},r=o=>{let s=Math.ceil(t/o)+1,i=2**(o-1);return{windows:s,windowSize:i}};return{constTimeNegate:n,unsafeLadder(o,s){let i=e.ZERO,c=o;for(;s>kc;)s&Ur&&(i=i.add(c)),c=c.double(),s>>=Ur;return i},precomputeWindow(o,s){let{windows:i,windowSize:c}=r(s),f=[],a=o,l=a;for(let u=0;u<i;u++){l=a,f.push(l);for(let g=1;g<c;g++)l=l.add(a),f.push(l);a=l.double()}return f},wNAF(o,s,i){let{windows:c,windowSize:f}=r(o),a=e.ZERO,l=e.BASE,u=BigInt(2**o-1),g=2**o,y=BigInt(o);for(let p=0;p<c;p++){let d=p*f,h=Number(i&u);i>>=y,h>f&&(h-=g,i+=Ur);let w=d,x=d+Math.abs(h)-1,E=p%2!==0,L=h<0;h===0?l=l.add(n(E,s[w])):a=a.add(n(L,s[x]))}return{p:a,f:l}},wNAFCached(o,s,i,c){let f=o._WINDOW_SIZE||1,a=s.get(o);return a||(a=this.precomputeWindow(o,f),f!==1&&s.set(o,c(a))),this.wNAF(f,a,i)}}}function Tr(e){return Lr(e.Fp),Ft(e,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...Sr(e.n,e.nBitLength),...e,p:e.Fp.ORDER})}function qc(e){let t=Tr(e);Ft(t,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});let{endo:n,Fp:r,a:o}=t;if(n){if(!r.eql(o,r.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if(typeof n!="object"||typeof n.beta!="bigint"||typeof n.splitScalar!="function")throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...t})}var{bytesToNumberBE:Cc,hexToBytes:Rc}=vr,ae={Err:class extends Error{constructor(t=""){super(t)}},_parseInt(e){let{Err:t}=ae;if(e.length<2||e[0]!==2)throw new t("Invalid signature integer tag");let n=e[1],r=e.subarray(2,n+2);if(!n||r.length!==n)throw new t("Invalid signature integer: wrong length");if(r[0]&128)throw new t("Invalid signature integer: negative");if(r[0]===0&&!(r[1]&128))throw new t("Invalid signature integer: unnecessary leading zero");return{d:Cc(r),l:e.subarray(n+2)}},toSig(e){let{Err:t}=ae,n=typeof e=="string"?Rc(e):e;if(!Et(n))throw new Error("ui8a expected");let r=n.length;if(r<2||n[0]!=48)throw new t("Invalid signature tag");if(n[1]!==r-2)throw new t("Invalid signature: incorrect length");let{d:o,l:s}=ae._parseInt(n.subarray(2)),{d:i,l:c}=ae._parseInt(s);if(c.length)throw new t("Invalid signature: left bytes after parsing");return{r:o,s:i}},hexFromSig(e){let t=a=>Number.parseInt(a[0],16)&8?"00"+a:a,n=a=>{let l=a.toString(16);return l.length&1?`0${l}`:l},r=t(n(e.s)),o=t(n(e.r)),s=r.length/2,i=o.length/2,c=n(s),f=n(i);return`30${n(i+s+4)}02${f}${o}02${c}${r}`}},Ct=BigInt(0),wt=BigInt(1),bu=BigInt(2),as=BigInt(3),xu=BigInt(4);function $c(e){let t=qc(e),{Fp:n}=t,r=t.toBytes||((p,d,h)=>{let w=d.toAffine();return ve(Uint8Array.from([4]),n.toBytes(w.x),n.toBytes(w.y))}),o=t.fromBytes||(p=>{let d=p.subarray(1),h=n.fromBytes(d.subarray(0,n.BYTES)),w=n.fromBytes(d.subarray(n.BYTES,2*n.BYTES));return{x:h,y:w}});function s(p){let{a:d,b:h}=t,w=n.sqr(p),x=n.mul(w,p);return n.add(n.add(x,n.mul(p,d)),h)}if(!n.eql(n.sqr(t.Gy),s(t.Gx)))throw new Error("bad generator point: equation left != right");function i(p){return typeof p=="bigint"&&Ct<p&&p<t.n}function c(p){if(!i(p))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function f(p){let{allowedPrivateKeyLengths:d,nByteLength:h,wrapPrivateKey:w,n:x}=t;if(d&&typeof p!="bigint"){if(Et(p)&&(p=ie(p)),typeof p!="string"||!d.includes(p.length))throw new Error("Invalid key");p=p.padStart(h*2,"0")}let E;try{E=typeof p=="bigint"?p:qt(lt("private key",p,h))}catch{throw new Error(`private key must be ${h} bytes, hex or bigint, not ${typeof p}`)}return w&&(E=rt(E,x)),c(E),E}let a=new Map;function l(p){if(!(p instanceof u))throw new Error("ProjectivePoint expected")}class u{constructor(d,h,w){if(this.px=d,this.py=h,this.pz=w,d==null||!n.isValid(d))throw new Error("x required");if(h==null||!n.isValid(h))throw new Error("y required");if(w==null||!n.isValid(w))throw new Error("z required")}static fromAffine(d){let{x:h,y:w}=d||{};if(!d||!n.isValid(h)||!n.isValid(w))throw new Error("invalid affine point");if(d instanceof u)throw new Error("projective point not allowed");let x=E=>n.eql(E,n.ZERO);return x(h)&&x(w)?u.ZERO:new u(h,w,n.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(d){let h=n.invertBatch(d.map(w=>w.pz));return d.map((w,x)=>w.toAffine(h[x])).map(u.fromAffine)}static fromHex(d){let h=u.fromAffine(o(lt("pointHex",d)));return h.assertValidity(),h}static fromPrivateKey(d){return u.BASE.multiply(f(d))}_setWindowSize(d){this._WINDOW_SIZE=d,a.delete(this)}assertValidity(){if(this.is0()){if(t.allowInfinityPoint&&!n.is0(this.py))return;throw new Error("bad point: ZERO")}let{x:d,y:h}=this.toAffine();if(!n.isValid(d)||!n.isValid(h))throw new Error("bad point: x or y not FE");let w=n.sqr(h),x=s(d);if(!n.eql(w,x))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){let{y:d}=this.toAffine();if(n.isOdd)return!n.isOdd(d);throw new Error("Field doesn't support isOdd")}equals(d){l(d);let{px:h,py:w,pz:x}=this,{px:E,py:L,pz:U}=d,B=n.eql(n.mul(h,U),n.mul(E,x)),A=n.eql(n.mul(w,U),n.mul(L,x));return B&&A}negate(){return new u(this.px,n.neg(this.py),this.pz)}double(){let{a:d,b:h}=t,w=n.mul(h,as),{px:x,py:E,pz:L}=this,U=n.ZERO,B=n.ZERO,A=n.ZERO,I=n.mul(x,x),k=n.mul(E,E),_=n.mul(L,L),T=n.mul(x,E);return T=n.add(T,T),A=n.mul(x,L),A=n.add(A,A),U=n.mul(d,A),B=n.mul(w,_),B=n.add(U,B),U=n.sub(k,B),B=n.add(k,B),B=n.mul(U,B),U=n.mul(T,U),A=n.mul(w,A),_=n.mul(d,_),T=n.sub(I,_),T=n.mul(d,T),T=n.add(T,A),A=n.add(I,I),I=n.add(A,I),I=n.add(I,_),I=n.mul(I,T),B=n.add(B,I),_=n.mul(E,L),_=n.add(_,_),I=n.mul(_,T),U=n.sub(U,I),A=n.mul(_,k),A=n.add(A,A),A=n.add(A,A),new u(U,B,A)}add(d){l(d);let{px:h,py:w,pz:x}=this,{px:E,py:L,pz:U}=d,B=n.ZERO,A=n.ZERO,I=n.ZERO,k=t.a,_=n.mul(t.b,as),T=n.mul(h,E),q=n.mul(w,L),C=n.mul(x,U),V=n.add(h,w),b=n.add(E,L);V=n.mul(V,b),b=n.add(T,q),V=n.sub(V,b),b=n.add(h,x);let m=n.add(E,U);return b=n.mul(b,m),m=n.add(T,C),b=n.sub(b,m),m=n.add(w,x),B=n.add(L,U),m=n.mul(m,B),B=n.add(q,C),m=n.sub(m,B),I=n.mul(k,b),B=n.mul(_,C),I=n.add(B,I),B=n.sub(q,I),I=n.add(q,I),A=n.mul(B,I),q=n.add(T,T),q=n.add(q,T),C=n.mul(k,C),b=n.mul(_,b),q=n.add(q,C),C=n.sub(T,C),C=n.mul(k,C),b=n.add(b,C),T=n.mul(q,b),A=n.add(A,T),T=n.mul(m,b),B=n.mul(V,B),B=n.sub(B,T),T=n.mul(V,q),I=n.mul(m,I),I=n.add(I,T),new u(B,A,I)}subtract(d){return this.add(d.negate())}is0(){return this.equals(u.ZERO)}wNAF(d){return y.wNAFCached(this,a,d,h=>{let w=n.invertBatch(h.map(x=>x.pz));return h.map((x,E)=>x.toAffine(w[E])).map(u.fromAffine)})}multiplyUnsafe(d){let h=u.ZERO;if(d===Ct)return h;if(c(d),d===wt)return this;let{endo:w}=t;if(!w)return y.unsafeLadder(this,d);let{k1neg:x,k1:E,k2neg:L,k2:U}=w.splitScalar(d),B=h,A=h,I=this;for(;E>Ct||U>Ct;)E&wt&&(B=B.add(I)),U&wt&&(A=A.add(I)),I=I.double(),E>>=wt,U>>=wt;return x&&(B=B.negate()),L&&(A=A.negate()),A=new u(n.mul(A.px,w.beta),A.py,A.pz),B.add(A)}multiply(d){c(d);let h=d,w,x,{endo:E}=t;if(E){let{k1neg:L,k1:U,k2neg:B,k2:A}=E.splitScalar(h),{p:I,f:k}=this.wNAF(U),{p:_,f:T}=this.wNAF(A);I=y.constTimeNegate(L,I),_=y.constTimeNegate(B,_),_=new u(n.mul(_.px,E.beta),_.py,_.pz),w=I.add(_),x=k.add(T)}else{let{p:L,f:U}=this.wNAF(h);w=L,x=U}return u.normalizeZ([w,x])[0]}multiplyAndAddUnsafe(d,h,w){let x=u.BASE,E=(U,B)=>B===Ct||B===wt||!U.equals(x)?U.multiplyUnsafe(B):U.multiply(B),L=E(this,h).add(E(d,w));return L.is0()?void 0:L}toAffine(d){let{px:h,py:w,pz:x}=this,E=this.is0();d==null&&(d=E?n.ONE:n.inv(x));let L=n.mul(h,d),U=n.mul(w,d),B=n.mul(x,d);if(E)return{x:n.ZERO,y:n.ZERO};if(!n.eql(B,n.ONE))throw new Error("invZ was invalid");return{x:L,y:U}}isTorsionFree(){let{h:d,isTorsionFree:h}=t;if(d===wt)return!0;if(h)return h(u,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){let{h:d,clearCofactor:h}=t;return d===wt?this:h?h(u,this):this.multiplyUnsafe(t.h)}toRawBytes(d=!0){return this.assertValidity(),r(u,this,d)}toHex(d=!0){return ie(this.toRawBytes(d))}}u.BASE=new u(t.Gx,t.Gy,n.ONE),u.ZERO=new u(n.ZERO,n.ONE,n.ZERO);let g=t.nBitLength,y=fs(u,t.endo?Math.ceil(g/2):g);return{CURVE:t,ProjectivePoint:u,normPrivateKeyToScalar:f,weierstrassEquation:s,isWithinCurveOrder:i}}function Vc(e){let t=Tr(e);return Ft(t,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...t})}function us(e){let t=Vc(e),{Fp:n,n:r}=t,o=n.BYTES+1,s=2*n.BYTES+1;function i(b){return Ct<b&&b<n.ORDER}function c(b){return rt(b,r)}function f(b){return Bn(b,r)}let{ProjectivePoint:a,normPrivateKeyToScalar:l,weierstrassEquation:u,isWithinCurveOrder:g}=$c({...t,toBytes(b,m,S){let O=m.toAffine(),v=n.toBytes(O.x),H=ve;return S?H(Uint8Array.from([m.hasEvenY()?2:3]),v):H(Uint8Array.from([4]),v,n.toBytes(O.y))},fromBytes(b){let m=b.length,S=b[0],O=b.subarray(1);if(m===o&&(S===2||S===3)){let v=qt(O);if(!i(v))throw new Error("Point is not on curve");let H=u(v),$=n.sqrt(H),R=($&wt)===wt;return(S&1)===1!==R&&($=n.neg($)),{x:v,y:$}}else if(m===s&&S===4){let v=n.fromBytes(O.subarray(0,n.BYTES)),H=n.fromBytes(O.subarray(n.BYTES,2*n.BYTES));return{x:v,y:H}}else throw new Error(`Point of length ${m} was invalid. Expected ${o} compressed bytes or ${s} uncompressed bytes`)}}),y=b=>ie(Jt(b,t.nByteLength));function p(b){let m=r>>wt;return b>m}function d(b){return p(b)?c(-b):b}let h=(b,m,S)=>qt(b.slice(m,S));class w{constructor(m,S,O){this.r=m,this.s=S,this.recovery=O,this.assertValidity()}static fromCompact(m){let S=t.nByteLength;return m=lt("compactSignature",m,S*2),new w(h(m,0,S),h(m,S,2*S))}static fromDER(m){let{r:S,s:O}=ae.toSig(lt("DER",m));return new w(S,O)}assertValidity(){if(!g(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!g(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(m){return new w(this.r,this.s,m)}recoverPublicKey(m){let{r:S,s:O,recovery:v}=this,H=A(lt("msgHash",m));if(v==null||![0,1,2,3].includes(v))throw new Error("recovery id invalid");let $=v===2||v===3?S+t.n:S;if($>=n.ORDER)throw new Error("recovery id 2 or 3 invalid");let R=v&1?"03":"02",P=a.fromHex(R+y($)),z=f($),Y=c(-H*z),tt=c(O*z),Z=a.BASE.multiplyAndAddUnsafe(P,Y,tt);if(!Z)throw new Error("point at infinify");return Z.assertValidity(),Z}hasHighS(){return p(this.s)}normalizeS(){return this.hasHighS()?new w(this.r,c(-this.s),this.recovery):this}toDERRawBytes(){return ce(this.toDERHex())}toDERHex(){return ae.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return ce(this.toCompactHex())}toCompactHex(){return y(this.r)+y(this.s)}}let x={isValidPrivateKey(b){try{return l(b),!0}catch{return!1}},normPrivateKeyToScalar:l,randomPrivateKey:()=>{let b=Ir(t.n);return cs(t.randomBytes(b),t.n)},precompute(b=8,m=a.BASE){return m._setWindowSize(b),m.multiply(BigInt(3)),m}};function E(b,m=!0){return a.fromPrivateKey(b).toRawBytes(m)}function L(b){let m=Et(b),S=typeof b=="string",O=(m||S)&&b.length;return m?O===o||O===s:S?O===2*o||O===2*s:b instanceof a}function U(b,m,S=!0){if(L(b))throw new Error("first arg must be private key");if(!L(m))throw new Error("second arg must be public key");return a.fromHex(m).multiply(l(b)).toRawBytes(S)}let B=t.bits2int||function(b){let m=qt(b),S=b.length*8-t.nBitLength;return S>0?m>>BigInt(S):m},A=t.bits2int_modN||function(b){return c(B(b))},I=ke(t.nBitLength);function k(b){if(typeof b!="bigint")throw new Error("bigint expected");if(!(Ct<=b&&b<I))throw new Error(`bigint expected < 2^${t.nBitLength}`);return Jt(b,t.nByteLength)}function _(b,m,S=T){if(["recovered","canonical"].some(D=>D in S))throw new Error("sign() legacy options not supported");let{hash:O,randomBytes:v}=t,{lowS:H,prehash:$,extraEntropy:R}=S;H==null&&(H=!0),b=lt("msgHash",b),$&&(b=lt("prehashed msgHash",O(b)));let P=A(b),z=l(m),Y=[k(z),k(P)];if(R!=null){let D=R===!0?v(n.BYTES):R;Y.push(lt("extraEntropy",D))}let tt=ve(...Y),Z=P;function st(D){let it=B(D);if(!g(it))return;let Ae=f(it),ct=a.BASE.multiply(it).toAffine(),M=c(ct.x);if(M===Ct)return;let ft=c(Ae*c(Z+M*z));if(ft===Ct)return;let Le=(ct.x===M?0:2)|Number(ct.y&wt),Se=ft;return H&&p(ft)&&(Se=d(ft),Le^=1),new w(M,Se,Le)}return{seed:tt,k2sig:st}}let T={lowS:t.lowS,prehash:!1},q={lowS:t.lowS,prehash:!1};function C(b,m,S=T){let{seed:O,k2sig:v}=_(b,m,S),H=t;return Br(H.hash.outputLen,H.nByteLength,H.hmac)(O,v)}a.BASE._setWindowSize(8);function V(b,m,S,O=q){var ct;let v=b;if(m=lt("msgHash",m),S=lt("publicKey",S),"strict"in O)throw new Error("options.strict was renamed to lowS");let{lowS:H,prehash:$}=O,R,P;try{if(typeof v=="string"||Et(v))try{R=w.fromDER(v)}catch(M){if(!(M instanceof ae.Err))throw M;R=w.fromCompact(v)}else if(typeof v=="object"&&typeof v.r=="bigint"&&typeof v.s=="bigint"){let{r:M,s:ft}=v;R=new w(M,ft)}else throw new Error("PARSE");P=a.fromHex(S)}catch(M){if(M.message==="PARSE")throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(H&&R.hasHighS())return!1;$&&(m=t.hash(m));let{r:z,s:Y}=R,tt=A(m),Z=f(Y),st=c(tt*Z),D=c(z*Z),it=(ct=a.BASE.multiplyAndAddUnsafe(P,st,D))==null?void 0:ct.toAffine();return it?c(it.x)===z:!1}return{CURVE:t,getPublicKey:E,getSharedSecret:U,sign:C,verify:V,ProjectivePoint:a,Signature:w,utils:x}}var vn=class extends Ee{constructor(t,n){super(),this.finished=!1,this.destroyed=!1,gn(t);let r=Yt(n);if(this.iHash=t.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let o=this.blockLen,s=new Uint8Array(o);s.set(r.length>o?t.create().update(r).digest():r);for(let i=0;i<s.length;i++)s[i]^=54;this.iHash.update(s),this.oHash=t.create();for(let i=0;i<s.length;i++)s[i]^=106;this.oHash.update(s),s.fill(0)}update(t){return me(this),this.iHash.update(t),this}digestInto(t){me(this),br(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){let t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));let{oHash:n,iHash:r,finished:o,destroyed:s,blockLen:i,outputLen:c}=this;return t=t,t.finished=o,t.destroyed=s,t.blockLen=i,t.outputLen=c,t.oHash=n._cloneInto(t.oHash),t.iHash=r._cloneInto(t.iHash),t}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}},qe=(e,t,n)=>new vn(e,t).update(n).digest();qe.create=(e,t)=>new vn(e,t);function Kc(e){return{hash:e,hmac:(t,...n)=>qe(e,t,Xo(...n)),randomBytes:Jo}}function ls(e,t){let n=r=>us({...e,...Kc(r)});return Object.freeze({...n(t),create:n})}var ps=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),ds=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),jc=BigInt(1),_r=BigInt(2),hs=(e,t)=>(e+t/_r)/t;function Pc(e){let t=ps,n=BigInt(3),r=BigInt(6),o=BigInt(11),s=BigInt(22),i=BigInt(23),c=BigInt(44),f=BigInt(88),a=e*e*e%t,l=a*a*e%t,u=dt(l,n,t)*l%t,g=dt(u,n,t)*l%t,y=dt(g,_r,t)*a%t,p=dt(y,o,t)*y%t,d=dt(p,s,t)*p%t,h=dt(d,c,t)*d%t,w=dt(h,f,t)*h%t,x=dt(w,c,t)*d%t,E=dt(x,n,t)*l%t,L=dt(E,i,t)*p%t,U=dt(L,r,t)*a%t,B=dt(U,_r,t);if(!Or.eql(Or.sqr(B),e))throw new Error("Cannot find square root");return B}var Or=ss(ps,void 0,void 0,{sqrt:Pc}),Nr=ls({a:BigInt(0),b:BigInt(7),Fp:Or,n:ds,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:e=>{let t=ds,n=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),r=-jc*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),o=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),s=n,i=BigInt("0x100000000000000000000000000000000"),c=hs(s*e,t),f=hs(-r*e,t),a=rt(e-c*n-f*o,t),l=rt(-c*r-f*s,t),u=a>i,g=l>i;if(u&&(a=t-a),g&&(l=t-l),a>i||l>i)throw new Error("splitScalar: Endomorphism failed, k="+e);return{k1neg:u,k1:a,k2neg:g,k2:l}}}},Be),Ou=BigInt(0);var Nu=Nr.ProjectivePoint;function Hr(e,t,n){return gn(e),n===void 0&&(n=new Uint8Array(e.outputLen)),qe(e,Yt(n),Yt(t))}import{bytesToHex as gs,hexToBytes as zc}from"helpers";function Zc(e,t,n){if(n??="nip44-v2",n.length>32)throw new Error("invalid salt length");let r=Nr.getSharedSecret(e,"02"+t).subarray(1,33);return Hr(Be,r,n)}var Zu={encrypt:wr.encrypt,decrypt:wr.decrypt,getConversationKey:Zc};function Mu(e,t,n){n??="default";let r=Hr(Be,e,n);return gs(Be(r+t))}function Du(){let e=crypto.getRandomValues(new Uint8Array(40)),n=2n**256n-0x14551231950b75fc4402da1732fc9bebfn;return(((i,c)=>{let f=i%c;return f>=0n?f:c+f})((i=>BigInt("0x"+(gs(i)||"0")))(e),n-1n)+1n).toString(16).padStart(64,"0")}function Wu(e){return fo(zc(e))}export{Du as generatePrivateKey,Wu as getPublicKey,Oo as nip04,Zu as nip44,Ki as npubEncode,Mu as obfuscate};
/*! Bundled license information:

@noble/hashes/esm/utils.js:
  (*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/utils.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/modular.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/curve.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/weierstrass.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/_shortw_utils.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/secp256k1.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/hashes/esm/utils.js:
  (*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/ciphers/esm/utils.js:
  (*! noble-ciphers - MIT License (c) 2023 Paul Miller (paulmillr.com) *)

@scure/base/lib/esm/index.js:
  (*! scure-base - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/hashes/esm/utils.js:
  (*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/utils.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/modular.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/curve.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/weierstrass.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/_shortw_utils.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/secp256k1.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)
*/
